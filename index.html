<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha256-XOqroi11tY4EFQMR9ZYwZWKj5ZXiftSx36RRuC3anlA=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">

<script class="next-config" data-name="main" type="application/json">{"hostname":"namgungjongmin.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.20.0","exturl":false,"sidebar":{"position":"left","width_expanded":320,"width_dual_column":240,"display":"post","padding":18,"offset":12},"copycode":{"enable":false,"style":null},"fold":{"enable":false,"height":500},"bookmark":{"enable":false,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":false,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta property="og:type" content="website">
<meta property="og:title" content="Namgung Jong Min">
<meta property="og:url" content="https://namgungjongmin.github.io/index.html">
<meta property="og:site_name" content="Namgung Jong Min">
<meta property="og:locale" content="ko_KR">
<meta property="article:author" content="Namgung Jong Min">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="https://namgungjongmin.github.io/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":true,"isPost":false,"lang":"ko","comments":"","permalink":"","path":"index.html","title":""}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Namgung Jong Min</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/rss2.xml" title="Namgung Jong Min" type="application/rss+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">Namgung Jong Min</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">토끼굴을 개척하는 개발자</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="검색" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>정보</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>태그</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>카테고리</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>아카이브</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          목차
        </li>
        <li class="sidebar-nav-overview">
          흝어보기
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Namgung Jong Min"
      src="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
  <p class="site-author-name" itemprop="name">Namgung Jong Min</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">50</span>
          <span class="site-state-item-name">포스트</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">카테고리</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">93</span>
        <span class="site-state-item-name">태그</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <a href="https://github.com/NamgungJongMin" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;NamgungJongMin" rel="noopener me" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:jmnamgung@gmail.com" title="E-Mail → mailto:jmnamgung@gmail.com" rel="noopener me" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>

        </div>
      </div>
    </div>

    
  </aside>


    </div>

    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://namgungjongmin.github.io/2025/01/23/project/wego/customfetcher/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
      <meta itemprop="name" content="Namgung Jong Min">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/23/project/wego/customfetcher/" class="post-title-link" itemprop="url">WEGO ) Custom Fetcher를 작성하여 API 공통 로직을 중앙 집중화하기!</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-01-23 13:32:33" itemprop="dateCreated datePublished" datetime="2025-01-23T13:32:33+09:00">2025-01-23</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2025/01/23/project/wego/customfetcher/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/01/23/project/wego/customfetcher/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://velog.velcdn.com/images/vbghdl/post/921dd816-acad-468d-b160-8e912a3d9f5f/image.png"></p>
<blockquote>
<p>API 통신은 현대 웹 애플리케이션의 핵심 요소입니다. 하지만 기본적인 fetch API를 직접 사용하면 다양한 문제점들이 발생할 수 있습니다. 이번 포스트에서는 우리 프로젝트에 Custom Fetcher를 도입하게 된 이유와 구현 방식, 효과에 대해 살펴보겠습니다.</p>
</blockquote>
<h1 id="▪︎-기존-fetch-사용-방식의-단점"><a href="#▪︎-기존-fetch-사용-방식의-단점" class="headerlink" title="▪︎ 기존 fetch 사용 방식의 단점"></a>▪︎ 기존 fetch 사용 방식의 단점</h1><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> getReview = <span class="keyword">async</span> (&#123; pageParam, sortOrder &#125;: <span class="title class_">ReviewParams</span>): <span class="title class_">Promise</span>&lt;<span class="title class_">ReviewResponse</span>&gt; =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`/api/reviews?page=<span class="subst">$&#123;pageParam&#125;</span>&amp;sortBy=<span class="subst">$&#123;sortOrder&#125;</span>&amp;limit=12`</span>, &#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">    <span class="attr">credentials</span>: <span class="string">&quot;include&quot;</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!res.<span class="property">ok</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> error = <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;Login failed&quot;</span>) <span class="keyword">as</span> <span class="title class_">ReviewError</span>;</span><br><span class="line">    error.<span class="property">status</span> = res.<span class="property">status</span>;</span><br><span class="line">    error.<span class="property">message</span> = <span class="string">`Server error: <span class="subst">$&#123;res.status&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> res.<span class="title function_">json</span>();</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>기존에 API 요청 코드들을 작성할 때에는 각 요청마다 method와 credentials와 같은 config 코드들을 작성해야 했고, 반환할 에러 타입들도 각각 작성해주어야 했습니다. 추가로 Next.js의 서버 컴포넌트와 같이 쿠키가 자동으로 실려가지 않는 상황에 대비하기 위한 코드들도 작성해야 했습니다.</p>
<p>따라서 API 관련 코드를 작성하는 개발자들은 각 API가 어디서 쓰일지, 어떤 설정이 필요한지를 매번 생각하고 코드에 적용해야 했습니다. 또한 이러한 API 요청 코드 구조의 변화가 있을 경우, 각 API 요청 코드를 전부 찾아가 일일이 수정해주어야 했습니다. 뿐만아니라 각 개발자마다 다른 구현 방식으로 인해 코드의 일관성이 떨어졌고, 이는 가독성을 저해하는 요소였습니다.</p>
<p>정리해보자면 다음과 같은 문제점들이 있었습니다.</p>
<ol>
<li>반복적인 코드<ul>
<li>기본 URL 설정</li>
<li>헤더 설정</li>
<li>에러 처리</li>
<li>응답 파싱</li>
</ul>
</li>
<li>일관성 부족<ul>
<li>개발자마다 다른 구현 방식</li>
<li>에러 처리 방식의 차이</li>
<li>타입 처리의 비일관성</li>
</ul>
</li>
<li>유지보수의 어려움<ul>
<li>API 로직 변경 시 여러 곳에 전체적인 수정 필요</li>
</ul>
</li>
</ol>
<p>위와 같은 기본 fetcher의 단점을 극복하기 위해 우리 프로젝트에 Custom Fetcher를 만들었습니다.</p>
<h1 id="▪︎-Custom-Fetcher-구현"><a href="#▪︎-Custom-Fetcher-구현" class="headerlink" title="▪︎ Custom Fetcher 구현"></a>▪︎ Custom Fetcher 구현</h1><h2 id="▫︎-전체-코드"><a href="#▫︎-전체-코드" class="headerlink" title="▫︎ 전체 코드"></a>▫︎ 전체 코드</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; <span class="title class_">FetcherError</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@/@types/api&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; getAccessTokenFromCookies &#125; <span class="keyword">from</span> <span class="string">&quot;@/utils/cookies&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> <span class="title class_">HTTPMethod</span> = <span class="string">&quot;GET&quot;</span> | <span class="string">&quot;POST&quot;</span> | <span class="string">&quot;PUT&quot;</span> | <span class="string">&quot;DELETE&quot;</span> | <span class="string">&quot;PATCH&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">FetcherConfig</span> <span class="keyword">extends</span> <span class="title class_">RequestInit</span> &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="title class_">HTTPMethod</span>;</span><br><span class="line">  credentials?: <span class="title class_">RequestCredentials</span>;</span><br><span class="line">  headers?: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;;</span><br><span class="line">  body?: <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">BASE_URL</span> = process.<span class="property">env</span>.<span class="property">NEXT_PUBLIC_BASE_URL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * HTTP 요청을 처리하는 기본 fetcher 함수</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">endpoint</span> - API 엔드포인트 경로</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> <span class="variable">config</span> - fetch 설정 객체</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@returns</span> Promise&lt;T&gt; - API 응답 데이터</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@throws</span> <span class="variable">FetcherError</span> - API 요청 실패 시 발생하는 에러</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> fetcher&lt;T&gt;(<span class="attr">endpoint</span>: <span class="built_in">string</span>, config?: <span class="title class_">FetcherConfig</span>): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">defaultConfig</span>: <span class="title class_">FetcherConfig</span> = &#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">    <span class="attr">credentials</span>: <span class="string">&quot;include&quot;</span>,</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">      <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> accessToken = <span class="keyword">typeof</span> <span class="variable language_">window</span> === <span class="string">&quot;undefined&quot;</span> ? <span class="keyword">await</span> <span class="title function_">getAccessTokenFromCookies</span>() : <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> mergedConfig = &#123;</span><br><span class="line">    ...defaultConfig,</span><br><span class="line">    ...config,</span><br><span class="line">    <span class="attr">headers</span>: <span class="title class_">Object</span>.<span class="title function_">fromEntries</span>(</span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">entries</span>(&#123;</span><br><span class="line">        ...defaultConfig.<span class="property">headers</span>,</span><br><span class="line">        ...config?.<span class="property">headers</span>,</span><br><span class="line">        ...(accessToken ? &#123; <span class="title class_">Cookie</span>: <span class="string">`accessToken=<span class="subst">$&#123;accessToken&#125;</span>`</span> &#125; : &#123;&#125;),</span><br><span class="line">        <span class="comment">// eslint-disable-next-line</span></span><br><span class="line">      &#125;).<span class="title function_">filter</span>(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> value !== <span class="literal">undefined</span>)</span><br><span class="line">    ),</span><br><span class="line">  &#125; <span class="keyword">as</span> <span class="title class_">FetcherConfig</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (mergedConfig.<span class="property">body</span> <span class="keyword">instanceof</span> <span class="title class_">FormData</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (mergedConfig.<span class="property">headers</span>) &#123;</span><br><span class="line">      <span class="keyword">delete</span> mergedConfig.<span class="property">headers</span>[<span class="string">&quot;Content-Type&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mergedConfig.<span class="property">body</span>) &#123;</span><br><span class="line">    mergedConfig.<span class="property">body</span> = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(mergedConfig.<span class="property">body</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span><span class="subst">$&#123;endpoint&#125;</span>`</span>, mergedConfig);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (endpoint === <span class="string">&quot;/auth/token/verification&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">status</span>: response.<span class="property">status</span> &#125; <span class="keyword">as</span> T;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!response.<span class="property">ok</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> error = <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;API request failed&quot;</span>) <span class="keyword">as</span> <span class="title class_">FetcherError</span>;</span><br><span class="line">    error.<span class="property">status</span> = response.<span class="property">status</span>;</span><br><span class="line">    error.<span class="property">message</span> = <span class="string">`Server error: <span class="subst">$&#123;response.status&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> response.<span class="title function_">json</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 편의성 메서드</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> http = &#123;</span><br><span class="line">  <span class="attr">get</span>: &lt;T,&gt;<span class="function">(<span class="params">endpoint: <span class="built_in">string</span>, config?: Omit&lt;FetcherConfig, <span class="string">&quot;method&quot;</span>&gt;</span>) =&gt;</span></span><br><span class="line">    fetcher&lt;T&gt;(endpoint, &#123; ...config, <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span> &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="attr">post</span>: &lt;T,&gt;<span class="function">(<span class="params">endpoint: <span class="built_in">string</span>, data?: <span class="built_in">any</span>, config?: Omit&lt;FetcherConfig, <span class="string">&quot;method&quot;</span> | <span class="string">&quot;body&quot;</span>&gt;</span>) =&gt;</span></span><br><span class="line">    fetcher&lt;T&gt;(endpoint, &#123; ...config, <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>, <span class="attr">body</span>: data &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="attr">put</span>: &lt;T,&gt;<span class="function">(<span class="params">endpoint: <span class="built_in">string</span>, data?: <span class="built_in">any</span>, config?: Omit&lt;FetcherConfig, <span class="string">&quot;method&quot;</span> | <span class="string">&quot;body&quot;</span>&gt;</span>) =&gt;</span></span><br><span class="line">    fetcher&lt;T&gt;(endpoint, &#123; ...config, <span class="attr">method</span>: <span class="string">&quot;PUT&quot;</span>, <span class="attr">body</span>: data &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="attr">delete</span>: &lt;T,&gt;<span class="function">(<span class="params">endpoint: <span class="built_in">string</span>, config?: Omit&lt;FetcherConfig, <span class="string">&quot;method&quot;</span>&gt;</span>) =&gt;</span></span><br><span class="line">    fetcher&lt;T&gt;(endpoint, &#123; ...config, <span class="attr">method</span>: <span class="string">&quot;DELETE&quot;</span> &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="attr">patch</span>: &lt;T,&gt;<span class="function">(<span class="params">endpoint: <span class="built_in">string</span>, data?: <span class="built_in">any</span>, config?: Omit&lt;FetcherConfig, <span class="string">&quot;method&quot;</span> | <span class="string">&quot;body&quot;</span>&gt;</span>) =&gt;</span></span><br><span class="line">    fetcher&lt;T&gt;(endpoint, &#123; ...config, <span class="attr">method</span>: <span class="string">&quot;PATCH&quot;</span>, <span class="attr">body</span>: data &#125;),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="▫︎-기본-구조-설정"><a href="#▫︎-기본-구조-설정" class="headerlink" title="▫︎ 기본 구조 설정"></a>▫︎ 기본 구조 설정</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> <span class="title class_">HTTPMethod</span> = <span class="string">&quot;GET&quot;</span> | <span class="string">&quot;POST&quot;</span> | <span class="string">&quot;PUT&quot;</span> | <span class="string">&quot;DELETE&quot;</span> | <span class="string">&quot;PATCH&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">FetcherConfig</span> <span class="keyword">extends</span> <span class="title class_">RequestInit</span> &#123;</span><br><span class="line">  <span class="attr">method</span>: <span class="title class_">HTTPMethod</span>;</span><br><span class="line">  credentials?: <span class="title class_">RequestCredentials</span>;</span><br><span class="line">  headers?: <span class="title class_">Record</span>&lt;<span class="built_in">string</span>, <span class="built_in">string</span>&gt;;</span><br><span class="line">  body?: <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="variable constant_">BASE_URL</span> = process.<span class="property">env</span>.<span class="property">NEXT_PUBLIC_BASE_URL</span>;</span><br></pre></td></tr></table></figure>

<p>우선 Custom Fetcher의 기본 구조를 타입스크립트를 통해 설정했습니다. 이를 통해 HTTP 메서드의 타입 안정성을 확보하였고, 설정 객체의 타입 또한 명확하게 정의했습니다.</p>
<h2 id="▫︎-핵심-Fetcher-함수"><a href="#▫︎-핵심-Fetcher-함수" class="headerlink" title="▫︎ 핵심 Fetcher 함수"></a>▫︎ 핵심 Fetcher 함수</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> fetcher&lt;T&gt;(<span class="attr">endpoint</span>: <span class="built_in">string</span>, config?: <span class="title class_">FetcherConfig</span>): <span class="title class_">Promise</span>&lt;T&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> <span class="attr">defaultConfig</span>: <span class="title class_">FetcherConfig</span> = &#123;</span><br><span class="line">    <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span>,</span><br><span class="line">    <span class="attr">credentials</span>: <span class="string">&quot;include&quot;</span>,</span><br><span class="line">    <span class="attr">headers</span>: &#123;</span><br><span class="line">      <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// SSR을 고려한 토큰 처리</span></span><br><span class="line">  <span class="keyword">const</span> accessToken = <span class="keyword">typeof</span> <span class="variable language_">window</span> === <span class="string">&quot;undefined&quot;</span> ? <span class="keyword">await</span> <span class="title function_">getAccessTokenFromCookies</span>() : <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> mergedConfig = &#123;</span><br><span class="line">    ...defaultConfig,</span><br><span class="line">    ...config,</span><br><span class="line">    <span class="attr">headers</span>: <span class="title class_">Object</span>.<span class="title function_">fromEntries</span>(</span><br><span class="line">      <span class="title class_">Object</span>.<span class="title function_">entries</span>(&#123;</span><br><span class="line">        ...defaultConfig.<span class="property">headers</span>,</span><br><span class="line">        ...config?.<span class="property">headers</span>,</span><br><span class="line">        ...(accessToken ? &#123; <span class="title class_">Cookie</span>: <span class="string">`accessToken=<span class="subst">$&#123;accessToken&#125;</span>`</span> &#125; : &#123;&#125;),</span><br><span class="line">        <span class="comment">// eslint-disable-next-line</span></span><br><span class="line">      &#125;).<span class="title function_">filter</span>(<span class="function">(<span class="params">[key, value]</span>) =&gt;</span> value !== <span class="literal">undefined</span>)</span><br><span class="line">    ),</span><br><span class="line">  &#125; <span class="keyword">as</span> <span class="title class_">FetcherConfig</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 특수 케이스 처리</span></span><br><span class="line">  <span class="keyword">if</span> (mergedConfig.<span class="property">body</span> <span class="keyword">instanceof</span> <span class="title class_">FormData</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (mergedConfig.<span class="property">headers</span>) &#123;</span><br><span class="line">      <span class="keyword">delete</span> mergedConfig.<span class="property">headers</span>[<span class="string">&quot;Content-Type&quot;</span>];</span><br><span class="line">    &#125;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (mergedConfig.<span class="property">body</span>) &#123;</span><br><span class="line">    mergedConfig.<span class="property">body</span> = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(mergedConfig.<span class="property">body</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> response = <span class="keyword">await</span> <span class="title function_">fetch</span>(<span class="string">`<span class="subst">$&#123;BASE_URL&#125;</span><span class="subst">$&#123;endpoint&#125;</span>`</span>, mergedConfig);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (endpoint === <span class="string">&quot;/auth/token/verification&quot;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123; <span class="attr">status</span>: response.<span class="property">status</span> &#125; <span class="keyword">as</span> T;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 커스텀 에러 객체를 사용하여 일관된 에러 형식 제공</span></span><br><span class="line">  <span class="keyword">if</span> (!response.<span class="property">ok</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> error = <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;API request failed&quot;</span>) <span class="keyword">as</span> <span class="title class_">FetcherError</span>;</span><br><span class="line">    error.<span class="property">status</span> = response.<span class="property">status</span>;</span><br><span class="line">    error.<span class="property">message</span> = <span class="string">`Server error: <span class="subst">$&#123;response.status&#125;</span>`</span>;</span><br><span class="line">    <span class="keyword">throw</span> error;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> response.<span class="title function_">json</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>fetcher 함수에서는 타입스크립트 제네릭을 통해 응답 타입을 보장할 수 있도록 하였습니다. 또한 기본적인 설정에 사용자 설정을 병합하도록 하여 보다 유연하고 확장성있게 사용될 수 있도록 하였습니다. 뿐만아니라 Next.js SSR 환경을 고려한 토큰 처리도 해주었습니다.</p>
<h3 id="특수케이스-처리"><a href="#특수케이스-처리" class="headerlink" title="특수케이스 처리"></a>특수케이스 처리</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (mergedConfig.<span class="property">body</span> <span class="keyword">instanceof</span> <span class="title class_">FormData</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (mergedConfig.<span class="property">headers</span>) &#123;</span><br><span class="line">    <span class="keyword">delete</span> mergedConfig.<span class="property">headers</span>[<span class="string">&quot;Content-Type&quot;</span>];</span><br><span class="line">  &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> <span class="keyword">if</span> (mergedConfig.<span class="property">body</span>) &#123;</span><br><span class="line">  mergedConfig.<span class="property">body</span> = <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(mergedConfig.<span class="property">body</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>우리 앱에서 기본적으로 사용되는 api 의 content type인 application&#x2F;json이 아닌 회원가입, 여행 만들기 등에 활용되는 FormData 타입일 때 content type을 바꿔주도록 구성했습니다. FormData 처리를 위해 Content-Type을 자동으로 제거하였고, JSON 데이터를 자동으로 직렬화하도록 하였습니다.</p>
<h3 id="에러-처리"><a href="#에러-처리" class="headerlink" title="에러 처리"></a>에러 처리</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!response.<span class="property">ok</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> error = <span class="keyword">new</span> <span class="title class_">Error</span>(<span class="string">&quot;API request failed&quot;</span>) <span class="keyword">as</span> <span class="title class_">FetcherError</span>;</span><br><span class="line">  error.<span class="property">status</span> = response.<span class="property">status</span>;</span><br><span class="line">  error.<span class="property">message</span> = <span class="string">`Server error: <span class="subst">$&#123;response.status&#125;</span>`</span>;</span><br><span class="line">  <span class="keyword">throw</span> error;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>에러처리는 Tanstack Query와의 조합을 생각하여 Query를 작성할 때 가독성이 좋을 것이라고 판단한 구조로 커스텀 에러 객체를 반환하도록 하였습니다. 이를 통해 HTTP 상태 코드를 포함한 객체와 메시지로 일관된 에러 형식을 제공할 수 있었습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">useMutation</span>(&#123;</span><br><span class="line">    <span class="attr">mutationFn</span>: login,</span><br><span class="line">    <span class="attr">onError</span>: <span class="function">(<span class="params">error: QueryError</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">switch</span> (error.<span class="property">status</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">401</span>:</span><br><span class="line">          <span class="title function_">showToast</span>(<span class="string">&#x27;잘못된 이메일 또는 비밀번호입니다.&#x27;</span>, <span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">          <span class="title function_">showToast</span>(<span class="string">&#x27;네트워크를 확인해주세요.&#x27;</span>, <span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">          <span class="title function_">showToast</span>(<span class="string">&#x27;알 수 없는 에러가 발생했습니다.&#x27;</span>, <span class="string">&#x27;error&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onSuccess</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      router.<span class="title function_">push</span>(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>백엔드에서 반환하는 response의 status를 바로 읽어 에러객체에 저장해주었고 실제 Tanstack Query에 사용할 때에는 에러 객체에서 status를 읽는 방식으로 가독성을 높이고 구조를 통일했습니다.</p>
<h2 id="▫︎-편의성-메서드"><a href="#▫︎-편의성-메서드" class="headerlink" title="▫︎ 편의성 메서드"></a>▫︎ 편의성 메서드</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> http = &#123;</span><br><span class="line">  <span class="attr">get</span>: &lt;T,&gt;<span class="function">(<span class="params">endpoint: <span class="built_in">string</span>, config?: Omit&lt;FetcherConfig, <span class="string">&quot;method&quot;</span>&gt;</span>) =&gt;</span></span><br><span class="line">    fetcher&lt;T&gt;(endpoint, &#123; ...config, <span class="attr">method</span>: <span class="string">&quot;GET&quot;</span> &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="attr">post</span>: &lt;T,&gt;<span class="function">(<span class="params">endpoint: <span class="built_in">string</span>, data?: <span class="built_in">any</span>, config?: Omit&lt;FetcherConfig, <span class="string">&quot;method&quot;</span> | <span class="string">&quot;body&quot;</span>&gt;</span>) =&gt;</span></span><br><span class="line">    fetcher&lt;T&gt;(endpoint, &#123; ...config, <span class="attr">method</span>: <span class="string">&quot;POST&quot;</span>, <span class="attr">body</span>: data &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="attr">put</span>: &lt;T,&gt;<span class="function">(<span class="params">endpoint: <span class="built_in">string</span>, data?: <span class="built_in">any</span>, config?: Omit&lt;FetcherConfig, <span class="string">&quot;method&quot;</span> | <span class="string">&quot;body&quot;</span>&gt;</span>) =&gt;</span></span><br><span class="line">    fetcher&lt;T&gt;(endpoint, &#123; ...config, <span class="attr">method</span>: <span class="string">&quot;PUT&quot;</span>, <span class="attr">body</span>: data &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="attr">delete</span>: &lt;T,&gt;<span class="function">(<span class="params">endpoint: <span class="built_in">string</span>, config?: Omit&lt;FetcherConfig, <span class="string">&quot;method&quot;</span>&gt;</span>) =&gt;</span></span><br><span class="line">    fetcher&lt;T&gt;(endpoint, &#123; ...config, <span class="attr">method</span>: <span class="string">&quot;DELETE&quot;</span> &#125;),</span><br><span class="line"></span><br><span class="line">  <span class="attr">patch</span>: &lt;T,&gt;<span class="function">(<span class="params">endpoint: <span class="built_in">string</span>, data?: <span class="built_in">any</span>, config?: Omit&lt;FetcherConfig, <span class="string">&quot;method&quot;</span> | <span class="string">&quot;body&quot;</span>&gt;</span>) =&gt;</span></span><br><span class="line">    fetcher&lt;T&gt;(endpoint, &#123; ...config, <span class="attr">method</span>: <span class="string">&quot;PATCH&quot;</span>, <span class="attr">body</span>: data &#125;),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>위에 서술한 fetcher함수를 이용하여 편의성 메서드를 작성하였습니다. 이를 통해 메서드별 타입을 최적화하고, 팀원들에게 간결한 사용법을 통한 일관된 인터페이스를 제공할 수 있었습니다.</p>
<h1 id="▪︎-실제-사용-예시"><a href="#▪︎-실제-사용-예시" class="headerlink" title="▪︎ 실제 사용 예시"></a>▪︎ 실제 사용 예시</h1><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getMyReview</span> = (<span class="params">limit: <span class="built_in">number</span>, offset: <span class="built_in">number</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http.<span class="property">get</span>&lt;<span class="title class_">ListResponse</span>&lt;<span class="title class_">Review</span>&gt;&gt;(<span class="string">`/reviews/mine?size=<span class="subst">$&#123;limit&#125;</span>&amp;page=<span class="subst">$&#123;offset&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">getReviewDetail</span> = (<span class="params">reviewId: <span class="built_in">number</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http.<span class="property">get</span>&lt;<span class="title class_">BaseResponse</span>&lt;<span class="title class_">Review</span>&gt;&gt;(<span class="string">`/reviews/<span class="subst">$&#123;reviewId&#125;</span>`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">postReviewLike</span> = (<span class="params">reviewId: <span class="built_in">number</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http.<span class="property">post</span>&lt;<span class="title class_">BaseResponse</span>&lt;<span class="built_in">unknown</span>&gt;&gt;(<span class="string">`/reviews/<span class="subst">$&#123;reviewId&#125;</span>/likes`</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">deleteReviewLike</span> = (<span class="params">reviewId: <span class="built_in">number</span></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> http.<span class="property">delete</span>&lt;<span class="title class_">BaseResponse</span>&lt;<span class="built_in">unknown</span>&gt;&gt;(<span class="string">`/reviews/<span class="subst">$&#123;reviewId&#125;</span>/likes`</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>처음 소개했던 기존 방식에 비해 훨씬 간결하고 가독성있게 API 요청 코드를 관리할 수 있게 되었습니다. API 설정 관련하여 고민하며 작성했던 기존 코드에 비해 중앙 집중화되어 관리되는 Custom Fetcher를 통해 실제 팀원들이 API 요청을 작성할 때에는 “메서드”, “엔드포인트”, “반환 타입”만 신경쓴다면 바로 쉽게 사용할 수 있었습니다.</p>
<h1 id="▪︎-마치며"><a href="#▪︎-마치며" class="headerlink" title="▪︎ 마치며"></a>▪︎ 마치며</h1><p>Custom Fetcher는 단순한 HTTP 클라이언트를 넘어 애플리케이션의 데이터 통신 계층을 체계화합니다. 타입 안정성, 코드 재사용성, 유지보수성을 모두 고려한 설계로, 개발 생산성을 크게 향상시킬 수 있습니다. 특히 Next.js의 서버 컴포넌트와 미들웨어 환경에서도 원활하게 동작하도록 구현되어, 현대적인 웹 애플리케이션 개발에 매우 적합합니다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://namgungjongmin.github.io/2025/01/22/project/wego/ssr/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
      <meta itemprop="name" content="Namgung Jong Min">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/22/project/wego/ssr/" class="post-title-link" itemprop="url">WEGO ) Next.js의 SSR을 활용한 SEO 최적화와 성능 개선</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-01-22 16:42:15" itemprop="dateCreated datePublished" datetime="2025-01-22T16:42:15+09:00">2025-01-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2025/01/22/project/wego/ssr/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/01/22/project/wego/ssr/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://velog.velcdn.com/images/vbghdl/post/921dd816-acad-468d-b160-8e912a3d9f5f/image.png"></p>
<h1 id="▪︎-데이터-페칭-방식의-이해-CSR-vs-SSR"><a href="#▪︎-데이터-페칭-방식의-이해-CSR-vs-SSR" class="headerlink" title="▪︎ 데이터 페칭 방식의 이해: CSR vs SSR"></a>▪︎ 데이터 페칭 방식의 이해: CSR vs SSR</h1><p>웹 애플리케이션에서 데이터를 가져오는 방식은 크게 클라이언트 사이드 렌더링(CSR)과 서버 사이드 렌더링(SSR)으로 나눌 수 있습니다.</p>
<p>클라이언트 사이드 데이터 페칭의 경우, 브라우저가 JavaScript를 실행하여 데이터를 가져오기 때문에 초기 HTML은 비어있는 상태입니다. 사용자는 데이터가 로드되기 전까지 로딩 상태를 보게 되며, 검색 엔진은 초기 HTML에서 의미 있는 컨텐츠를 찾을 수 없습니다.</p>
<p>반면 서버 사이드 데이터 페칭은 서버에서 데이터를 미리 가져와 완성된 HTML을 생성합니다. 이는 사용자에게 더 빠른 초기 로드 경험을 제공하며, 검색 엔진이 컨텐츠를 즉시 크롤링할 수 있게 합니다.</p>
<h1 id="▪︎-SEO에서-SSR의-장점"><a href="#▪︎-SEO에서-SSR의-장점" class="headerlink" title="▪︎ SEO에서 SSR의 장점"></a>▪︎ SEO에서 SSR의 장점</h1><p>검색 엔진 최적화(SEO)에 있어서 SSR은 다음과 같은 핵심적인 이점을 제공합니다.</p>
<h2 id="▫︎-완성된-HTML-제공"><a href="#▫︎-완성된-HTML-제공" class="headerlink" title="▫︎ 완성된 HTML 제공"></a>▫︎ <strong>완성된 HTML 제공</strong></h2><ul>
<li>검색 엔진 크롤러가 JavaScript 실행 없이도 모든 컨텐츠 접근 가능</li>
<li>메타 데이터와 구조화된 데이터를 초기 HTML에 포함 가능</li>
</ul>
<h2 id="▫︎-빠른-초기-로드"><a href="#▫︎-빠른-초기-로드" class="headerlink" title="▫︎ 빠른 초기 로드"></a>▫︎ <strong>빠른 초기 로드</strong></h2><ul>
<li>Time to First Contentful Paint (FCP) 개선</li>
<li>사용자 경험 향상으로 인한 간접적 SEO 효과</li>
</ul>
<h2 id="▫︎-신뢰성-있는-컨텐츠-제공"><a href="#▫︎-신뢰성-있는-컨텐츠-제공" class="headerlink" title="▫︎ 신뢰성 있는 컨텐츠 제공"></a>▫︎ <strong>신뢰성 있는 컨텐츠 제공</strong></h2><ul>
<li>동적 데이터 로딩으로 인한 컨텐츠 누락 방지</li>
<li>일관된 컨텐츠 구조 제공</li>
</ul>
<h1 id="▪︎-프로젝트-적용-구현-예시"><a href="#▪︎-프로젝트-적용-구현-예시" class="headerlink" title="▪︎ 프로젝트 적용 (구현 예시)"></a>▪︎ 프로젝트 적용 (구현 예시)</h1><p>예시로 우리 프로젝트에서는 리뷰 상세 페이지에 SSR을 적용했습니다. 이 페이지는 정적인 정보를 주로 다루며 SEO가 중요한 페이지이기 때문입니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/app/review/[id]/page.tsx</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">ReviewDetailPage</span> = <span class="keyword">async</span> (<span class="params">&#123; params &#125;: &#123; params: <span class="built_in">Promise</span>&lt;&#123; id: <span class="built_in">number</span> &#125;&gt; &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; id &#125; = <span class="keyword">await</span> params;</span><br><span class="line">  <span class="keyword">const</span> queryClient = <span class="keyword">new</span> <span class="title class_">QueryClient</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// fetchQuery를 사용한 서버 사이드 데이터 페칭</span></span><br><span class="line">  <span class="keyword">await</span> queryClient.<span class="title function_">fetchQuery</span>(&#123;</span><br><span class="line">    <span class="attr">queryKey</span>: [<span class="string">&quot;reviews&quot;</span>, <span class="string">&quot;detail&quot;</span>, id],</span><br><span class="line">    <span class="attr">queryFn</span>: <span class="function">() =&gt;</span> <span class="title function_">getReviewDetail</span>(id),</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> data = queryClient.<span class="property">getQueryData</span>&lt;<span class="title class_">BaseResponse</span>&lt;<span class="title class_">Review</span>&gt;&gt;([<span class="string">&quot;reviews&quot;</span>, <span class="string">&quot;detail&quot;</span>, id]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;pb-[120px]&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Header</span> <span class="attr">title</span>=<span class="string">&quot;리뷰 상세보기&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;data &amp;&amp; <span class="tag">&lt;<span class="name">ReviewDetailContainer</span> <span class="attr">data</span>=<span class="string">&#123;data.data&#125;</span> /&gt;</span>&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="▫︎-fetchQuery-vs-prefetchQuery"><a href="#▫︎-fetchQuery-vs-prefetchQuery" class="headerlink" title="▫︎ fetchQuery vs prefetchQuery"></a>▫︎ <strong>fetchQuery vs prefetchQuery</strong></h2><p>구현 과정에서 fetchQuery와 prefetchQuery 중 어떤 것을 사용할지 고민했습니다. 테스트 결과 fetchQuery가 더 나은 성능을 보여주었는데, 이는 다음과 같은 이유 때문입니다.</p>
<h3 id="fetchQuery"><a href="#fetchQuery" class="headerlink" title="fetchQuery"></a>fetchQuery</h3><ul>
<li>데이터를 즉시 가져오고 캐시에 저장</li>
<li>Promise가 resolve될 때까지 대기</li>
<li>데이터가 확실히 있는 상태에서 렌더링 시작</li>
</ul>
<h3 id="prefetchQuery"><a href="#prefetchQuery" class="headerlink" title="prefetchQuery"></a>prefetchQuery</h3><ul>
<li>백그라운드에서 데이터를 가져옴</li>
<li>데이터 로딩 완료를 기다리지 않음</li>
<li>때로는 데이터가 없는 상태에서 렌더링이 시작될 수 있음</li>
</ul>
<p>prefetchQuery의 경우 가져온 데이터들을 즉시 캐시에 저장하고 반영하는 것이 아니라 prefetch를 통해 백그라운드에 저장해놓은 데이터를 다시 한번 캐시에 등록하는 과정이 추가됩니다. 따라서 fetchQuery에 비해 로딩 속도가 비교적 낮았습니다.</p>
<h1 id="▪︎-성능-측정-및-개선-효과"><a href="#▪︎-성능-측정-및-개선-효과" class="headerlink" title="▪︎ 성능 측정 및 개선 효과"></a>▪︎ <strong>성능 측정 및 개선 효과</strong></h1><p>SSR 적용 후 다음과 같은 개선 효과를 확인할 수 있었습니다.</p>
<h2 id="▫︎-검색엔진-크롤링-향상"><a href="#▫︎-검색엔진-크롤링-향상" class="headerlink" title="▫︎ 검색엔진 크롤링 향상"></a>▫︎ <strong>검색엔진 크롤링 향상</strong></h2><ul>
<li>Google Search Console의 색인 생성 증가</li>
<li>크롤링 오류 감소</li>
</ul>
<h2 id="▫︎-페이지-성능-개선"><a href="#▫︎-페이지-성능-개선" class="headerlink" title="▫︎ 페이지 성능 개선"></a>▫︎ 페이지 성능 개선</h2><p>기존 CSR 방식과 비교하여 LCP 지표에서 큰 차이가 있었습니다.</p>
<p><img src="https://velog.velcdn.com/images/vbghdl/post/bc9f022d-2211-4b5b-bbe4-347c8b3e5f53/image.png" alt="image.png"></p>
<p>기존 CSR 방식) LCP: 654.93 ms</p>
<p><img src="https://velog.velcdn.com/images/vbghdl/post/7baf6991-8e19-43c2-a01d-9e8a2b2f66fb/image.png" alt="image.png"></p>
<p>수정 SSR 방식) LCP: 182.55 ms</p>
<p>기존 하위 클라이언트 컴포넌트에서 각 데이터를 페칭하여 페이지에 적용했을 경우 LCP 지표가 654.93 ms로 확인되었습니다. 그러나 SSR을 적용한 이후에는 182.55 ms로 약 72% 개선한 수치를 보여주었습니다.</p>
<h2 id="▫︎-LCP-지표-개선의-이유"><a href="#▫︎-LCP-지표-개선의-이유" class="headerlink" title="▫︎ LCP 지표 개선의 이유"></a>▫︎ LCP 지표 개선의 이유</h2><p>LCP 지표에 이렇게 큰 차이가 발생하는 이유를 단계별로 확인해보겠습니다.</p>
<h3 id="CSR의-렌더링-단계-654-93ms"><a href="#CSR의-렌더링-단계-654-93ms" class="headerlink" title="CSR의 렌더링 단계 (654.93ms)"></a>CSR의 렌더링 단계 (654.93ms)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1. 빈 HTML 다운로드</span><br><span class="line">2. JavaScript 번들 다운로드</span><br><span class="line">3. React 초기화</span><br><span class="line">4. useQuery 실행</span><br><span class="line">5. API 요청 및 대기</span><br><span class="line">6. 데이터 수신</span><br><span class="line">7. DOM 렌더링</span><br><span class="line">8. 이미지 로드 시작</span><br></pre></td></tr></table></figure>

<h3 id="SSR의-렌더링-단계-182-55ms"><a href="#SSR의-렌더링-단계-182-55ms" class="headerlink" title="SSR의 렌더링 단계 (182.55ms)"></a>SSR의 렌더링 단계 (182.55ms)</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. 서버에서 데이터 페칭 (다른 단계와 병렬 처리)</span><br><span class="line">2. 서버에서 HTML 생성</span><br><span class="line">3. 완성된 HTML 다운로드 (이미지 URL 포함)</span><br><span class="line">4. 이미지 로드 시작 (HTML 파싱과 동시에)</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>네트워크 요청 최적화</strong><ul>
<li>CSR: HTML → JS → API (순차적)</li>
<li>SSR: HTML(데이터 포함) → 리소스 (병렬)</li>
</ul>
</li>
<li><strong>렌더링 프로세스 최적화</strong><ul>
<li>CSR: JS 실행 → 데이터 페칭 → 렌더링</li>
<li>SSR: 서버에서 미리 렌더링 완료</li>
</ul>
</li>
<li><strong>리소스 로딩 최적화</strong><ul>
<li>CSR: 데이터 수신 후 이미지 로드 시작</li>
<li>SSR: HTML 파싱과 동시에 이미지 로드</li>
</ul>
</li>
</ul>
<p>이 측정 결과는 SEO뿐만 아니라 성능 측면에서도 SSR이 매우 효과적인 선택이었음을 입증합니다.</p>
<h1 id="▪︎-마치며"><a href="#▪︎-마치며" class="headerlink" title="▪︎ 마치며"></a>▪︎ 마치며</h1><p>SSR을 통한 SEO 최적화는 현대 웹 애플리케이션에서 필수적인 요소입니다. 특히 Next.js의 서버 컴포넌트를 활용하면 효과적으로 SSR을 구현할 수 있으며, 이는 검색 엔진 최적화뿐만 아니라 전반적인 사용자 경험 향상에도 큰 도움이 됩니다.</p>
<p>우리 프로젝트에서는 fetchQuery를 활용한 서버 사이드 데이터 페칭으로 완성도 높은 SSR을 구현했으며, 이는 SEO와 성능 모두에서 긍정적인 결과를 가져왔습니다. 앞으로도 지속적인 모니터링과 최적화를 통해 더 나은 사용자 경험을 제공할 계획입니다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://namgungjongmin.github.io/2025/01/21/project/wego/cls%EC%B5%9C%EC%A0%81%ED%99%94/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
      <meta itemprop="name" content="Namgung Jong Min">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/21/project/wego/cls%EC%B5%9C%EC%A0%81%ED%99%94/" class="post-title-link" itemprop="url">WEGO ) 레이아웃 시프팅 현상을 해결하여 CLS 지표 개선하기</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-01-21 20:12:15" itemprop="dateCreated datePublished" datetime="2025-01-21T20:12:15+09:00">2025-01-21</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2025/01/21/project/wego/cls%EC%B5%9C%EC%A0%81%ED%99%94/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/01/21/project/wego/cls최적화/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://velog.velcdn.com/images/vbghdl/post/921dd816-acad-468d-b160-8e912a3d9f5f/image.png"></p>
<h1 id="▪︎-CLS란-무엇일까"><a href="#▪︎-CLS란-무엇일까" class="headerlink" title="▪︎ CLS란 무엇일까?"></a>▪︎ <strong>CLS란 무엇일까?</strong></h1><p>CLS(Cumulative Layout Shift)는 Google의 Core Web Vitals 중 하나로, 페이지 로딩 과정에서 발생하는 예기치 않은 레이아웃 이동을 측정하는 지표입니다. 쉽게 말해, 페이지가 얼마나 ‘덜컥거리는지’를 수치화한 것입니다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[CLS 점수 기준]</span><br><span class="line">좋음: 0.1 이하</span><br><span class="line">개선 필요: 0.1 ~ 0.25</span><br><span class="line">나쁨: 0.25 이상</span><br></pre></td></tr></table></figure>

<p>CLS 수치가 점수 기준에서 합격점이라 할지라도 실제 페이지에서 유저가 경험할 때 부자연스러운 부분들이 있을 수 있습니다. WEGO 프로젝트에서 시프팅 현상으로 인한 부자연스로운 페이지 로딩의 예시를 살펴보고, 개선 방법들을 적용하여 실제 CLS 지표의 변화까지 살펴보겠습니다.</p>
<h1 id="▪︎-레이아웃-시프트가-사용자-경험에-미치는-영향"><a href="#▪︎-레이아웃-시프트가-사용자-경험에-미치는-영향" class="headerlink" title="▪︎ 레이아웃 시프트가 사용자 경험에 미치는 영향"></a>▪︎ 레이아웃 시프트가 사용자 경험에 미치는 영향</h1><p>레이아웃 시프트는 다음과 같은 부정적인 영향을 미칩니다.</p>
<h2 id="▫︎-사용자-불편"><a href="#▫︎-사용자-불편" class="headerlink" title="▫︎ 사용자 불편"></a>▫︎ <strong>사용자 불편</strong></h2><ul>
<li>읽고 있던 텍스트의 위치가 갑자기 변경</li>
<li>클릭하려던 버튼이 순간적으로 이동</li>
<li>스크롤 위치의 예상치 못한 변화</li>
</ul>
<h2 id="▫︎-신뢰성-저하"><a href="#▫︎-신뢰성-저하" class="headerlink" title="▫︎ 신뢰성 저하"></a>▫︎ <strong>신뢰성 저하</strong></h2><ul>
<li>웹사이트의 완성도가 떨어져 보임</li>
<li>전문성에 대한 의구심 유발</li>
<li>사용자의 재방문율 감소</li>
</ul>
<h1 id="▪︎-프로젝트에서-발견된-CLS-이슈"><a href="#▪︎-프로젝트에서-발견된-CLS-이슈" class="headerlink" title="▪︎ 프로젝트에서 발견된 CLS 이슈"></a>▪︎ 프로젝트에서 발견된 CLS 이슈</h1><h2 id="▫︎-스크롤바-시프팅"><a href="#▫︎-스크롤바-시프팅" class="headerlink" title="▫︎ 스크롤바 시프팅"></a>▫︎ 스크롤바 시프팅</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[문제 상황]</span><br><span class="line">1. 초기 페이지 로드 시 데이터 없음 -&gt; 스크롤바 없음</span><br><span class="line">2. 데이터 로드 완료 -&gt; 스크롤바 생성</span><br><span class="line">3. 페이지 너비가 스크롤바 너비만큼 감소</span><br><span class="line">4. 전체 레이아웃이 왼쪽으로 시프트</span><br></pre></td></tr></table></figure>

<p><img src="https://velog.velcdn.com/images/vbghdl/post/03240db9-3c9c-4e90-8cce-ac339c9b74c4/image.png" alt="image.png"></p>
<h3 id="해결-방안-1-min-height"><a href="#해결-방안-1-min-height" class="headerlink" title="해결 방안 1) min-height"></a>해결 방안 1) min-height</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 항상 스크롤바 공간 확보 */</span></span><br><span class="line"><span class="selector-class">.page-container</span> &#123;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">101</span>dvh; <span class="comment">/* 스크롤바가 항상 표시되도록 설정 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>간단하면서 효율적인 방식으로 해결하는 방법으로 min-height에 적정한 값을 주어 항상 스크롤이 존재하는 페이지로 보여주는 방법을 적용하였습니다.</p>
<h3 id="해결-방안-2-Skeleton-UI"><a href="#해결-방안-2-Skeleton-UI" class="headerlink" title="해결 방안 2) Skeleton UI"></a>해결 방안 2) Skeleton UI</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line">   <span class="keyword">if</span> (isLoading) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">ReviewSkeleton</span> /&gt;</span></span>;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>데이터 페칭이 진행중일 때, 스크롤바가 생길 정도의 데이터만큼 스켈레톤 UI를 렌더링하여 스크롤바가 존재하도록 하였습니다.</p>
<blockquote>
<p>위 두가지 방법을 통해 페이지 초기 로드 시부터 스크롤바 공간을 확보하여 레이아웃의 변화가 없도록 하였고 일관된 사용자 경험을 제공할 수 있었습니다.</p>
</blockquote>
<h3 id="개선-이후-측정-결과"><a href="#개선-이후-측정-결과" class="headerlink" title="개선 이후 측정 결과"></a>개선 이후 측정 결과</h3><p><img src="https://velog.velcdn.com/images/vbghdl/post/fd4f4a7e-44e8-4050-b2f2-ad8af599ccc2/image.png" alt="image.png"></p>
<h2 id="▫︎-이미지-시프팅"><a href="#▫︎-이미지-시프팅" class="headerlink" title="▫︎ 이미지 시프팅"></a>▫︎ 이미지 시프팅</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="title class_">Image</span></span><br><span class="line">  src=&#123;travelImage&#125;</span><br><span class="line">  alt=&#123;<span class="string">`<span class="subst">$&#123;travelName&#125;</span> - <span class="subst">$&#123;travelLocation&#125;</span> 여행 이미지`</span>&#125;</span><br><span class="line">  width=&#123;<span class="number">300</span>&#125;</span><br><span class="line">  height=&#123;<span class="number">300</span>&#125;</span><br><span class="line">  className=<span class="string">&quot;h-full w-full rounded object-cover&quot;</span> <span class="comment">// 이미지 로드 전후로 스타일 변경</span></span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>

<p>이미지가 로드되면서 object-fit의 기본값에서 object-cover가 적용되는 과정이 화면에 보여지며 덜컥거리는 현상이 발생하였습니다.</p>
<p><img src="https://velog.velcdn.com/images/vbghdl/post/38b10722-7549-4d1e-b019-c6b6c494f4ab/image.png" alt="image.png"></p>
<h3 id="해결방안"><a href="#해결방안" class="headerlink" title="해결방안"></a>해결방안</h3><p>이를 해결하기 위해 Next.js Image 컴포넌트의 onLoadingComplete 속성을 적용하여 이미지가 완전 로드되기 전까지는 투명상태를 유지하고, 로드 완료 시 부드러운 페이드인 효과를 적용하였습니다.</p>
<h3 id="개선-이후-측정-결과-1"><a href="#개선-이후-측정-결과-1" class="headerlink" title="개선 이후 측정 결과"></a>개선 이후 측정 결과</h3><p><img src="https://velog.velcdn.com/images/vbghdl/post/f3794c68-4a73-46af-ba0f-2937e6d45b55/image.png" alt="image.png"></p>
<h1 id="▪︎-개선-효과"><a href="#▪︎-개선-효과" class="headerlink" title="▪︎ 개선 효과"></a>▪︎ 개선 효과</h1><ol>
<li><strong>사용자 경험 향상</strong><ul>
<li>부드러운 페이지 전환</li>
<li>예측 가능한 인터랙션</li>
<li>전문적인 웹사이트 인상</li>
</ul>
</li>
<li><strong>성능 지표 개선</strong><ul>
<li>CLS 점수 0.1 이하 달성</li>
<li>Core Web Vitals 전반적 향상</li>
<li>모바일 사용성 개선</li>
</ul>
</li>
<li><strong>비즈니스 효과</strong><ul>
<li>사용자 이탈률 감소</li>
<li>페이지 체류 시간 증가</li>
<li>전환율 향상 가능성</li>
</ul>
</li>
</ol>
<h1 id="▪︎-마치며"><a href="#▪︎-마치며" class="headerlink" title="▪︎ 마치며"></a>▪︎ 마치며</h1><p>CLS 최적화는 단순한 성능 지표의 개선을 넘어 사용자 경험의 질적 향상을 가져옵니다. 특히 무한 스크롤이나 동적 이미지 로딩이 많은 현대 웹 애플리케이션에서는 필수적인 최적화 요소입니다. 우리 프로젝트에서 적용한 두 가지 해결 방안은 간단하면서도 효과적인 CLS 최적화 전략의 좋은 예시가 될 수 있습니다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://namgungjongmin.github.io/2025/01/20/project/wego/skeleton/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
      <meta itemprop="name" content="Namgung Jong Min">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/20/project/wego/skeleton/" class="post-title-link" itemprop="url">WEGO ) Skeleton UI를 활용한 웹 성능 및 사용자 경험 최적화</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-01-20 23:32:35" itemprop="dateCreated datePublished" datetime="2025-01-20T23:32:35+09:00">2025-01-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2025/01/20/project/wego/skeleton/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/01/20/project/wego/skeleton/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://velog.velcdn.com/images/vbghdl/post/921dd816-acad-468d-b160-8e912a3d9f5f/image.png"></p>
<blockquote>
<p>웹 애플리케이션에서 데이터 로딩은 피할 수 없는 과정입니다. 특히 네트워크 상태가 불안정하거나 대량의 데이터를 처리해야 하는 경우, 사용자는 빈 화면이나 로딩 스피너를 보며 기다려야 합니다. 이러한 대기 시간은 사용자 경험을 저하시키는 주요 요인이 됩니다. 이 문제를 해결하기 위해 저희는 스켈레톤 UI를 구현하여 적용했습니다.</p>
</blockquote>
<h1 id="▪︎-Skeleton-UI-구현-과정"><a href="#▪︎-Skeleton-UI-구현-과정" class="headerlink" title="▪︎ Skeleton UI 구현 과정"></a>▪︎ Skeleton UI 구현 과정</h1><h2 id="▫︎-기본-스타일-설정"><a href="#▫︎-기본-스타일-설정" class="headerlink" title="▫︎ 기본 스타일 설정"></a>▫︎ 기본 스타일 설정</h2><p>먼저 Tailwind 설정 파일에서 스켈레톤 UI의 기본 스타일을 정의했습니다. 스켈레톤 UI의 핵심은 로딩 상태를 시각적으로 표현하는 애니메이션입니다. 이를 위해 그라데이션 효과와 움직임을 결합했습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// tailwind.config.ts</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">addUtilities</span>(&#123;</span><br><span class="line">  <span class="string">&quot;.skeleton-style&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">background</span>: <span class="string">&quot;linear-gradient(90deg, #E5E7EB 35%, #F3F4F6 50%, #E5E7EB 65%)&quot;</span>,</span><br><span class="line">    <span class="attr">backgroundSize</span>: <span class="string">&quot;300% auto&quot;</span>,</span><br><span class="line">    <span class="attr">animation</span>: <span class="string">&quot;skeleton-loading 1.5s ease-in-out infinite&quot;</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">&quot;@keyframes skeleton-loading&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;0%&quot;</span>: &#123; <span class="attr">backgroundPosition</span>: <span class="string">&quot;100% 0&quot;</span> &#125;,</span><br><span class="line">    <span class="string">&quot;100%&quot;</span>: &#123; <span class="attr">backgroundPosition</span>: <span class="string">&quot;0 0&quot;</span> &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>이 설정은 세 가지 주요 요소로 구성됩니다.</p>
<ul>
<li>그라데이션 배경: 밝은 회색(#F3F4F6)에서 어두운 회색(#E5E7EB)으로 자연스럽게 변화</li>
<li>배경 크기: 실제 요소보다 3배 큰 배경을 설정하여 부드러운 이동 효과 구현</li>
<li>애니메이션: 1.5초 동안 배경이 좌우로 움직이며 무한 반복</li>
</ul>
<h2 id="▫︎-재사용-가능한-스켈레톤-컴포넌트"><a href="#▫︎-재사용-가능한-스켈레톤-컴포넌트" class="headerlink" title="▫︎ 재사용 가능한 스켈레톤 컴포넌트"></a>▫︎ <strong>재사용 가능한 스켈레톤 컴포넌트</strong></h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Skeleton.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Skeleton</span> = (<span class="params">&#123; className, classNameCondition &#125;: Props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&#123;cn(</span>&quot;<span class="attr">skeleton-style</span>&quot;, <span class="attr">className</span>, <span class="attr">classNameCondition</span>)&#125; /&gt;</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>이 컴포넌트는 단순하지만 유연합니다. className prop을 통해 각 사용처에 맞는 크기와 스타일을 적용할 수 있으며, classNameCondition을 통해 조건부 스타일링도 가능합니다.</p>
<h2 id="▫︎-실제-적용-여행-카드-스켈레톤"><a href="#▫︎-실제-적용-여행-카드-스켈레톤" class="headerlink" title="▫︎ 실제 적용 (여행 카드 스켈레톤)"></a>▫︎ 실제 적용 (여행 카드 스켈레톤)</h2><p>마이페이지에서 MyTravelCardSkeleton 을 적용한 예시입니다. 실제 데이터가 로드되기 전의 UI를 표현합니다.</p>
<h3 id="컴포넌트에-적용할-Skeleton-UI-작성"><a href="#컴포넌트에-적용할-Skeleton-UI-작성" class="headerlink" title="컴포넌트에 적용할 Skeleton UI 작성"></a>컴포넌트에 적용할 Skeleton UI 작성</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyTravelCardSkeleton.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">MyTravelCardSkeleton</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;w-full max-w-[335px] pb-10 md:max-w-[688px] xl:max-w-[1400px]&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;grid w-full gap-5 xl:grid-cols-2 xl:gap-6&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;Array.from(&#123; length: 6 &#125;).map((_, index) =&gt; (</span></span><br><span class="line"><span class="language-xml">          // eslint-disable-next-line react/no-array-index-key</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;</span>`<span class="attr">skeleton-</span>$&#123;<span class="attr">index</span>&#125;`&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;relative flex max-w-[335px] gap-4 md:max-w-[688px] md:gap-9&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Skeleton</span> <span class="attr">className</span>=<span class="string">&quot;h-[120px] w-[100px] flex-shrink-0 rounded md:h-[160px] md:w-[223px]&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;relative flex w-full flex-col justify-between&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;flex flex-col gap-1&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">Skeleton</span> <span class="attr">className</span>=<span class="string">&quot;h-5 w-12 rounded-[20px]&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">Skeleton</span> <span class="attr">className</span>=<span class="string">&quot;h-6 w-full md:h-[26px]&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;flex flex-col gap-2.5&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">Skeleton</span> <span class="attr">className</span>=<span class="string">&quot;h-5 w-full&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                  <span class="tag">&lt;<span class="name">Skeleton</span> <span class="attr">className</span>=<span class="string">&quot;h-4 w-full&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Skeleton</span> <span class="attr">className</span>=<span class="string">&quot;mt-5 h-[1px] w-full max-w-[1400px]&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        ))&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="마이페이지-여행-카드에-적용"><a href="#마이페이지-여행-카드에-적용" class="headerlink" title="마이페이지 여행 카드에 적용"></a>마이페이지 여행 카드에 적용</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">Upcomming</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> itemsPerPage = <span class="number">6</span>;</span><br><span class="line">  <span class="keyword">const</span> [currentPage, setCurrentPage] = <span class="title function_">useState</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">data</span>: travels, isLoading &#125; = <span class="title function_">useUpcommingTravel</span>(itemsPerPage, currentPage - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">const</span> totalPages = travels ? <span class="title class_">Math</span>.<span class="title function_">ceil</span>(travels.<span class="property">data</span>.<span class="property">total</span> / itemsPerPage) : <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">paginate</span> = (<span class="params">pageNumber: <span class="built_in">number</span></span>) =&gt; <span class="title function_">setCurrentPage</span>(pageNumber);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (isLoading) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">MyTravelCardSkeleton</span> /&gt;</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">section</span> <span class="attr">className</span>=<span class="string">&quot;w-full max-w-[335px] pb-10 md:max-w-[688px] xl:max-w-[1400px]&quot;</span> <span class="attr">data-testid</span>=<span class="string">&quot;upcomming-travels&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;travels &amp;&amp; travels.data.total &gt; 0 ? (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;grid w-full gap-5 xl:grid-cols-2 xl:gap-6&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;travels.data?.content.map((travel: TravelCardProps) =&gt; (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">key</span>=<span class="string">&#123;travel.travelId&#125;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">TravelCard</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">key</span>=<span class="string">&#123;travel.travelId&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">travelId</span>=<span class="string">&#123;travel.travelId&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">travelImage</span>=<span class="string">&#123;travel.travelImage&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">isDomestic</span>=<span class="string">&#123;travel.isDomestic&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">travelName</span>=<span class="string">&#123;travel.travelName&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">travelLocation</span>=<span class="string">&#123;travel.travelLocation&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">maxTravelMateCount</span>=<span class="string">&#123;travel.maxTravelMateCount&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">currentTravelMateCount</span>=<span class="string">&#123;travel.currentTravelMateCount&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">startAt</span>=<span class="string">&#123;travel.startAt&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">endAt</span>=<span class="string">&#123;travel.endAt&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">bookmarkFlag</span>=<span class="string">&#123;travel.bookmarkFlag&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">formattedStartDate</span>=<span class="string">&#123;checkTomorrow(travel.startAt)&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              /&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">HorizontalDivider</span> <span class="attr">className</span>=<span class="string">&quot;mt-5 xl:mt-6&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ))&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      ) : (</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">NoTravel</span> <span class="attr">message</span>=<span class="string">&quot;아직 참여한 여행이 없어요!&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">      )&#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Pagination</span> <span class="attr">totalPages</span>=<span class="string">&#123;totalPages&#125;</span> <span class="attr">currentPage</span>=<span class="string">&#123;currentPage&#125;</span> <span class="attr">paginate</span>=<span class="string">&#123;paginate&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>이 컴포넌트는 실제 여행 카드 리스트와 동일한 레이아웃을 가지며, 반응형 디자인을 지원합니다. 6개의 더미 카드를 생성하여 데이터 로딩 중에도 페이지의 구조를 명확히 보여줍니다.</p>
<h2 id="▫︎-완성된-Skeleton-UI"><a href="#▫︎-완성된-Skeleton-UI" class="headerlink" title="▫︎ 완성된 Skeleton UI"></a>▫︎ 완성된 Skeleton UI</h2><p><img src="https://velog.velcdn.com/images/vbghdl/post/9360c31a-bde2-404e-8f58-a4a0c28f1b19/image.gif" alt="image.png"></p>
<h1 id="▪︎-효과"><a href="#▪︎-효과" class="headerlink" title="▪︎ 효과"></a>▪︎ 효과</h1><p>스켈레톤 UI 구현은 Core Web Vitals를 포함한 주요 웹 성능 메트릭스의 개선에 큰 영향을 미쳤습니다. 성능의 개선은 사용자 경험 향상으로도 이어집니다.</p>
<h2 id="▫︎-FCP-First-Contentful-Paint-최적화"><a href="#▫︎-FCP-First-Contentful-Paint-최적화" class="headerlink" title="▫︎ FCP(First Contentful Paint) 최적화"></a>▫︎ <strong>FCP(First Contentful Paint) 최적화</strong></h2><p>스켈레톤 UI는 FCP 개선에도 기여합니다. 페이지의 첫 번째 의미 있는 콘텐츠가 그려지는 시점이 빨라지기 때문입니다.</p>
<ul>
<li><strong>즉각적인 시각적 피드백</strong>: 스켈레톤 UI는 실제 콘텐츠보다 훨씬 가벼워, 페이지 진입 시 즉시 렌더링됩니다.</li>
<li><strong>점진적 로딩</strong>: 메인 콘텐츠가 로드되는 동안 의미 있는 UI를 제공하여 체감 LCP를 개선합니다.</li>
<li><strong>레이아웃 안정성</strong>: CLS(Cumulative Layout Shift) 또한 개선되어, 콘텐츠 로드 시 레이아웃 변화를 최소화합니다.</li>
</ul>
<p><img src="https://velog.velcdn.com/images/vbghdl/post/6091e539-ba73-431b-af15-f0ebd88f1de3/image.png"></p>
<p>Chrome Dev Tools의 성능 탭에서 같은 조건으로 확인해봤을 때 다음과 같은 차이가 있었습니다. 생각보다 큰 차이가 있어 놀랐습니다.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[스켈레톤 UI 적용 전]</span><br><span class="line">FCP: 559.8ms</span><br><span class="line"></span><br><span class="line">[스켈레톤 UI 적용 후]</span><br><span class="line">FCP: 119ms (약 78% 개선)</span><br></pre></td></tr></table></figure>

<p>이러한 성능 개선은 특히 모바일 사용자와 불안정한 네트워크 환경에서 더욱 큰 효과를 발휘합니다. Google의 Core Web Vitals 지표 개선은 검색 엔진 최적화(SEO)에도 긍정적인 영향을 미치며, 이는 결과적으로 웹사이트의 가시성 향상으로 이어집니다.</p>
<h1 id="▪︎-마치며"><a href="#▪︎-마치며" class="headerlink" title="▪︎ 마치며"></a>▪︎ 마치며</h1><p>스켈레톤 UI 구현을 통해 다음과 같은 효과를 얻을 수 있었습니다:</p>
<ol>
<li><strong>인지된 성능 향상</strong><ul>
<li>사용자는 빈 화면이나 로딩 스피너 대신 콘텐츠의 구조를 즉시 확인할 수 있습니다.</li>
<li>이는 실제 로딩 시간이 동일하더라도 더 빠르게 느껴지는 효과를 줍니다.</li>
</ul>
</li>
<li><strong>자연스러운 전환</strong><ul>
<li>스켈레톤에서 실제 콘텐츠로의 전환이 부드럽게 이루어집니다.</li>
<li>레이아웃 시프트가 최소화되어 더 안정적인 사용자 경험을 제공합니다.</li>
</ul>
</li>
<li><strong>프로그레시브 로딩</strong><ul>
<li>페이지의 구조가 먼저 로드되어 사용자가 전체적인 레이아웃을 파악할 수 있습니다.</li>
<li>이는 특히 모바일 환경에서 중요한 이점을 제공합니다.</li>
</ul>
</li>
<li><strong>반응형 디자인 지원</strong><ul>
<li>스켈레톤 UI도 실제 컴포넌트와 동일한 반응형 규칙을 따릅니다.</li>
<li>모든 화면 크기에서 일관된 로딩 경험을 제공합니다.</li>
<li></li>
</ul>
</li>
</ol>
<p>이러한 스켈레톤 UI 구현은 단순한 시각적 개선을 넘어 전반적인 사용자 경험 향상에 기여했습니다.</p>
<p>특히 네트워크 상태가 불안정한 모바일 환경에서 더욱 효과적으로 작동하며, 사용자의 이탈률을 줄이는 데 도움이 될 것이라 생각합니다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://namgungjongmin.github.io/2025/01/17/project/wego/%EC%9D%B8%EC%A6%9D%ED%8F%BC%EA%B5%AC%ED%98%84/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
      <meta itemprop="name" content="Namgung Jong Min">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/17/project/wego/%EC%9D%B8%EC%A6%9D%ED%8F%BC%EA%B5%AC%ED%98%84/" class="post-title-link" itemprop="url">WEGO ) 커스텀 훅을 활용한 인증 폼 구현과 리렌더링 최적화</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-01-17 21:52:55" itemprop="dateCreated datePublished" datetime="2025-01-17T21:52:55+09:00">2025-01-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2025/01/17/project/wego/%EC%9D%B8%EC%A6%9D%ED%8F%BC%EA%B5%AC%ED%98%84/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/01/17/project/wego/인증폼구현/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://velog.velcdn.com/images/vbghdl/post/921dd816-acad-468d-b160-8e912a3d9f5f/image.png"></p>
<h1 id="▪︎-로그인-폼-구현-과정과-고민들"><a href="#▪︎-로그인-폼-구현-과정과-고민들" class="headerlink" title="▪︎ 로그인 폼 구현 과정과 고민들"></a>▪︎ 로그인 폼 구현 과정과 고민들</h1><h2 id="▫︎-상태-관리-방식의-선택"><a href="#▫︎-상태-관리-방식의-선택" class="headerlink" title="▫︎ 상태 관리 방식의 선택"></a>▫︎ 상태 관리 방식의 선택</h2><p>로그인 폼을 구현할 때 가장 먼저 고민했던 것은 입력값을 어떤 방식으로 관리할 것인가였습니다. React에서는 크게 두 가지 접근 방식이 있습니다:</p>
<h3 id="제어-컴포넌트-Controlled-Component"><a href="#제어-컴포넌트-Controlled-Component" class="headerlink" title="제어 컴포넌트 (Controlled Component)"></a><strong>제어 컴포넌트 (Controlled Component)</strong></h3><ul>
<li>리액트가 폼 데이터를 완전히 제어</li>
<li>useState를 사용하여 상태 관리</li>
<li>실시간으로 입력값 검증 가능</li>
</ul>
<h3 id="비제어-컴포넌트-Uncontrolled-Component"><a href="#비제어-컴포넌트-Uncontrolled-Component" class="headerlink" title="비제어 컴포넌트 (Uncontrolled Component)"></a><strong>비제어 컴포넌트 (Uncontrolled Component)</strong></h3><ul>
<li>DOM이 폼 데이터를 처리</li>
<li>useRef를 사용하여 DOM에 직접 접근</li>
<li>필요할 때만 값을 참조</li>
</ul>
<p>저는 다음과 같은 3가지 이유로 useState를 선택하여 구현하였습니다.</p>
<h3 id="1-상태의-본질"><a href="#1-상태의-본질" class="headerlink" title="1. 상태의 본질"></a>1. 상태의 본질</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">LoginForm</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">const</span> email = <span class="title function_">useAuthInput</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;email&#x27;</span> &#125;);</span><br><span class="line">    <span class="keyword">const</span> password = <span class="title function_">useAuthInput</span>(&#123; <span class="attr">name</span>: <span class="string">&#x27;password&#x27;</span> &#125;);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>입력값은 시간에 따라 변화하는 애플리케이션의 상태</li>
<li>UI에 즉시 반영되어야 하는 데이터</li>
<li>상태 변화에 따른 부수 효과(유효성 검증) 필요</li>
</ul>
<h3 id="2-실시간-유효성-검증"><a href="#2-실시간-유효성-검증" class="headerlink" title="2. 실시간 유효성 검증"></a>2. 실시간 유효성 검증</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> validate = (&#123; name, value, password &#125;: <span class="title class_">ValidateOptions</span>): <span class="function"><span class="params">boolean</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (name) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;email&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">REGEX</span>.<span class="property">email</span>.<span class="title function_">test</span>(value);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>사용자 경험 향상을 위한 즉각적인 피드백 필요</li>
<li>상태 변화를 감지하여 자동으로 검증 수행</li>
</ul>
<h3 id="3-제어-컴포넌트의-이점"><a href="#3-제어-컴포넌트의-이점" class="headerlink" title="3. 제어 컴포넌트의 이점"></a>3. 제어 컴포넌트의 이점</h3><ul>
<li>폼 데이터에 대한 완벽한 제어 가능</li>
<li>입력값 포맷팅이나 제한 용이</li>
<li>여러 입력 필드 간의 연동 용이</li>
</ul>
<h2 id="▫︎-로직을-분리하여-기능-구현"><a href="#▫︎-로직을-분리하여-기능-구현" class="headerlink" title="▫︎ 로직을 분리하여 기능 구현"></a>▫︎ 로직을 분리하여 기능 구현</h2><p>코드의 재사용성과 유지보수성을 높이기 위해 다음과 같이 구조를 분리했습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// hooks/useAuthInput.ts</span></span><br><span class="line"><span class="comment">// 상태 관리와 이벤트 핸들링을 위한 커스텀 훅</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useAuthInput</span> = (<span class="params">&#123; name, password &#125;: Props</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> [value, setValue] = <span class="title function_">useState</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> [isValid, setIsValid] = useState&lt;<span class="built_in">boolean</span> | <span class="literal">null</span>&gt;(<span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> debouncedValidate = <span class="title function_">useMemo</span>(</span><br><span class="line">    <span class="function">() =&gt;</span></span><br><span class="line">      <span class="title function_">debounce</span>(<span class="function">(<span class="params">newValue: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (!newValue) &#123;</span><br><span class="line">          <span class="title function_">setIsValid</span>(<span class="literal">null</span>);</span><br><span class="line">          <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> validationResult = <span class="title function_">validate</span>(&#123; name, <span class="attr">value</span>: newValue, password &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="title function_">setIsValid</span>(validationResult);</span><br><span class="line">      &#125;, <span class="number">250</span>),</span><br><span class="line">    [name, password]</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> handleChange = <span class="title function_">useCallback</span>(</span><br><span class="line">    <span class="function">(<span class="params">e: React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">const</span> newValue = e.<span class="property">target</span>.<span class="property">value</span>;</span><br><span class="line"></span><br><span class="line">      <span class="title function_">setValue</span>(newValue);</span><br><span class="line">      <span class="title function_">debouncedValidate</span>(newValue);</span><br><span class="line">    &#125;,</span><br><span class="line">    [debouncedValidate]</span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      debouncedValidate.<span class="title function_">cancel</span>();</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;, [debouncedValidate]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    value,</span><br><span class="line">    isValid,</span><br><span class="line">    setValue,</span><br><span class="line">    setIsValid,</span><br><span class="line">    handleChange,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// utils/validateAuthInput.ts</span></span><br><span class="line"><span class="comment">// 유효성 검증 로직</span></span><br><span class="line"><span class="keyword">const</span> validate = (&#123; name, value, password &#125;: <span class="title class_">ValidateOptions</span>): <span class="function"><span class="params">boolean</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">switch</span> (name) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;email&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">REGEX</span>.<span class="property">email</span>.<span class="title function_">test</span>(value);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;password&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">REGEX</span>.<span class="property">password</span>.<span class="title function_">test</span>(value);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;passwordConfirm&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> password ? value === password : <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;currentPassword&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">REGEX</span>.<span class="property">currentPassword</span>.<span class="title function_">test</span>(value);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;newPassword&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">REGEX</span>.<span class="property">newPassword</span>.<span class="title function_">test</span>(value);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;name&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">REGEX</span>.<span class="property">name</span>.<span class="title function_">test</span>(value);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;nickname&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">REGEX</span>.<span class="property">nickname</span>.<span class="title function_">test</span>(value);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;contact&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">REGEX</span>.<span class="property">contact</span>.<span class="title function_">test</span>(value);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;birthDate&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">REGEX</span>.<span class="property">birthDate</span>.<span class="title function_">test</span>(value);</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;verifyNumber&quot;</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="variable constant_">REGEX</span>.<span class="property">verifyNumber</span>.<span class="title function_">test</span>(value);</span><br><span class="line">    <span class="attr">default</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// components/auth/form/loginForm.tsx</span></span><br><span class="line"><span class="comment">// UI 컴포넌트</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">LoginForm</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> email = <span class="title function_">useAuthInput</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;email&quot;</span> &#125;);</span><br><span class="line">  <span class="keyword">const</span> password = <span class="title function_">useAuthInput</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;password&quot;</span> &#125;);</span><br><span class="line">  <span class="keyword">const</span> &#123; <span class="attr">mutate</span>: login, <span class="attr">isPending</span>: isLoggingIn &#125; = <span class="title function_">useLogin</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleLogin</span> = (<span class="params">e: React.FormEvent&lt;HTMLFormElement&gt;</span>) =&gt; &#123;</span><br><span class="line">    e.<span class="title function_">preventDefault</span>();</span><br><span class="line"></span><br><span class="line">    <span class="title function_">login</span>(&#123;</span><br><span class="line">      <span class="attr">email</span>: email.<span class="property">value</span>,</span><br><span class="line">      <span class="attr">password</span>: password.<span class="property">value</span>,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">form</span> <span class="attr">className</span>=<span class="string">&quot;mb-4 w-full&quot;</span> <span class="attr">onSubmit</span>=<span class="string">&#123;handleLogin&#125;</span> <span class="attr">data-testid</span>=<span class="string">&quot;login-form&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AuthText</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&quot;email&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;email&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">size</span>=<span class="string">&quot;full&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;email.value&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">isValid</span>=<span class="string">&#123;email.isValid&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;email.handleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AuthPassword</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">name</span>=<span class="string">&quot;password&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">value</span>=<span class="string">&#123;password.value&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">isValid</span>=<span class="string">&#123;password.isValid&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">onChange</span>=<span class="string">&#123;password.handleChange&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">label</span>=<span class="string">&quot;로그인&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">size</span>=<span class="string">&quot;full&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&quot;mt-[180px] hover:bg-primary-normal&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">disabled</span>=<span class="string">&#123;!email.isValid</span> || !<span class="attr">password.isValid</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">showSpinner</span>=<span class="string">&#123;isLoggingIn&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      /&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>이러한 구조는 각 부분의 책임이 명확하다는 점, 테스트가 용이하다는 점, 코드의 재사용성이 향상된다는 장점이 있습니다.</p>
<h1 id="▪︎-상태-공존과-리렌더링-최적화"><a href="#▪︎-상태-공존과-리렌더링-최적화" class="headerlink" title="▪︎ 상태 공존과 리렌더링 최적화"></a>▪︎ <strong>상태 공존과 리렌더링 최적화</strong></h1><h2 id="▫︎-상태-공존-State-Colocation"><a href="#▫︎-상태-공존-State-Colocation" class="headerlink" title="▫︎ 상태 공존 (State Colocation)"></a>▫︎ 상태 공존 (State Colocation)</h2><p>상태 공존이란 하나의 컴포넌트 내에서 여러 개의 독립적인 상태가 함께 존재하는 상황을 말합니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">LoginForm</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> email = <span class="title function_">useAuthInput</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;email&quot;</span> &#125;); <span class="comment">// 상태 1</span></span><br><span class="line">  <span class="keyword">const</span> password = <span class="title function_">useAuthInput</span>(&#123; <span class="attr">name</span>: <span class="string">&quot;password&quot;</span> &#125;); <span class="comment">// 상태 2</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">form</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AuthText</span> &#123;<span class="attr">...email</span>&#125; /&gt;</span> // 이메일 입력 시 패스워드도 리렌더링</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">AuthPassword</span> &#123;<span class="attr">...password</span>&#125; /&gt;</span> // 패스워드 입력 시 이메일도 리렌더링</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>상태 공존으로 인해 한 입력 필드의 상태 변화가 다른 필드의 불필요한 리렌더링을 유발한다는 문제점이 있었습니다. 이것은 성능 저하로 이어지고 결국 사용자 경험을 저하시키는 결과를 낳을 수 있었습니다.</p>
<p>이를 위해 메모이제이션 기능을 이용한 최적화 전략을 사용하기로 했습니다.</p>
<h2 id="▫︎-memoization을-통한-최적화"><a href="#▫︎-memoization을-통한-최적화" class="headerlink" title="▫︎ memoization을 통한 최적화"></a>▫︎ memoization을 통한 최적화</h2><h3 id="React-memo를-통한-컴포넌트-메모이제이션"><a href="#React-memo를-통한-컴포넌트-메모이제이션" class="headerlink" title="React.memo를 통한 컴포넌트 메모이제이션"></a>React.memo를 통한 컴포넌트 메모이제이션</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">AuthText</span> = <span class="title function_">memo</span>(</span><br><span class="line">  <span class="function">(<span class="params">&#123;</span></span></span><br><span class="line"><span class="params"><span class="function">    <span class="keyword">type</span>,</span></span></span><br><span class="line"><span class="params"><span class="function">    name,</span></span></span><br><span class="line"><span class="params"><span class="function">    value,</span></span></span><br><span class="line"><span class="params"><span class="function">    isValid,</span></span></span><br><span class="line"><span class="params"><span class="function">  &#125;: <span class="comment">// ...</span></span></span></span><br><span class="line"><span class="params"><span class="function">  Props</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>props가 변경되지 않은 컴포넌트의 리렌더링 방지</li>
<li>각 입력 필드가 독립적으로 렌더링</li>
</ul>
<h3 id="useCallback을-통한-이벤트-핸들러-메모이제이션"><a href="#useCallback을-통한-이벤트-핸들러-메모이제이션" class="headerlink" title="useCallback을 통한 이벤트 핸들러 메모이제이션"></a>useCallback을 통한 이벤트 핸들러 메모이제이션</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> handleChange = <span class="title function_">useCallback</span>(</span><br><span class="line">  <span class="function">(<span class="params">e: React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> newValue = e.<span class="property">target</span>.<span class="property">value</span>;</span><br><span class="line">    <span class="title function_">setValue</span>(newValue);</span><br><span class="line">    <span class="title function_">debouncedValidate</span>(newValue);</span><br><span class="line">  &#125;,</span><br><span class="line">  [debouncedValidate]</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>매 렌더링마다 새로운 함수가 생성되는 것을 방지</li>
<li>의존성 배열에 debouncedValidate만 포함하여 불필요한 재생성 방지</li>
</ul>
<h3 id="useMemo를-통한-검증-함수-메모이제이션"><a href="#useMemo를-통한-검증-함수-메모이제이션" class="headerlink" title="useMemo를 통한 검증 함수 메모이제이션"></a>useMemo를 통한 검증 함수 메모이제이션</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> debouncedValidate = <span class="title function_">useMemo</span>(</span><br><span class="line">  <span class="function">() =&gt;</span></span><br><span class="line">    <span class="title function_">debounce</span>(<span class="function">(<span class="params">newValue: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!newValue) &#123;</span><br><span class="line">        <span class="title function_">setIsValid</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> validationResult = <span class="title function_">validate</span>(&#123; name, <span class="attr">value</span>: newValue, password &#125;);</span><br><span class="line">      <span class="title function_">setIsValid</span>(validationResult);</span><br><span class="line">    &#125;, <span class="number">250</span>),</span><br><span class="line">  [name, password]</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<ul>
<li>고비용 연산인 debounce 함수의 재생성 방지</li>
<li>의존성이 변경될 때만 새로운 함수 생성</li>
</ul>
<h1 id="▪︎-결과"><a href="#▪︎-결과" class="headerlink" title="▪︎ 결과"></a>▪︎ 결과</h1><p>이러한 최적화 전략들을 적용한 결과 다음과 같은 점들이 개선되었습니다.</p>
<h3 id="1-성능-향상"><a href="#1-성능-향상" class="headerlink" title="1. 성능 향상"></a>1. 성능 향상</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[리렌더링 패턴]</span><br><span class="line">최적화 전: Input1 변경 → 모든 Input 리렌더링</span><br><span class="line">최적화 후: Input1 변경 → Input1만 리렌더링</span><br></pre></td></tr></table></figure>

<h3 id="2-메모리-사용-개선"><a href="#2-메모리-사용-개선" class="headerlink" title="2. 메모리 사용 개선"></a>2. 메모리 사용 개선</h3><ul>
<li>불필요한 함수 생성 감소</li>
<li>효율적인 메모리 관리</li>
</ul>
<h3 id="3-사용자-경험-개선"><a href="#3-사용자-경험-개선" class="headerlink" title="3. 사용자 경험 개선"></a>3. 사용자 경험 개선</h3><ul>
<li>입력 지연 감소</li>
<li>부드러운 UI 업데이트</li>
</ul>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://namgungjongmin.github.io/2025/01/15/project/wego/debounce/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
      <meta itemprop="name" content="Namgung Jong Min">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/15/project/wego/debounce/" class="post-title-link" itemprop="url">WEGO ) input validate 함수에 debounce를 적용하여 리소스 낭비 방지하기</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-01-15 23:22:47" itemprop="dateCreated datePublished" datetime="2025-01-15T23:22:47+09:00">2025-01-15</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2025/01/15/project/wego/debounce/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/01/15/project/wego/debounce/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://velog.velcdn.com/images/vbghdl/post/921dd816-acad-468d-b160-8e912a3d9f5f/image.png"></p>
<blockquote>
<p>사용자의 입력을 실시간으로 검증하는 기능을 구현할 때, 가장 먼저 고려해야 할 것은 성능과 메모리 관리입니다. 특히 이메일이나 비밀번호와 같은 입력 필드에서는 사용자가 타이핑하는 동안 지속적으로 유효성 검증이 발생하게 되는데, 이는 불필요한 연산과 메모리 사용을 초래할 수 있습니다. 이러한 문제를 해결하기 위해 debounce 기법을 활용한 최적화 방법을 소개하고자 합니다.</p>
</blockquote>
<h1 id="▪︎-Debounce를-활용한-최적화-구현"><a href="#▪︎-Debounce를-활용한-최적화-구현" class="headerlink" title="▪︎ Debounce를 활용한 최적화 구현"></a>▪︎ Debounce를 활용한 최적화 구현</h1><p>사용자가 입력 필드에 타이핑을 할 때마다 유효성 검증 함수가 실행되면 다음과 같은 문제가 발생할 수 있습니다:</p>
<ul>
<li><strong>불필요한 연산 발생</strong>: 사용자가 ‘<a href="mailto:&#101;&#x78;&#x61;&#109;&#x70;&#108;&#101;&#64;&#103;&#x6d;&#x61;&#x69;&#108;&#46;&#x63;&#111;&#x6d;">&#101;&#x78;&#x61;&#109;&#x70;&#108;&#101;&#64;&#103;&#x6d;&#x61;&#x69;&#108;&#46;&#x63;&#111;&#x6d;</a>‘을 입력한다고 가정했을 때, 각 글자가 입력될 때마다 이메일 유효성 검증이 실행됩니다. 즉, ‘e’, ‘ex’, ‘exa’… 와 같이 완성되지 않은 상태에서도 검증이 수행되는 것입니다.</li>
<li><strong>리소스 낭비</strong>: 특히 복잡한 유효성 검증 로직이나 API 호출이 포함된 경우, 불필요한 리소스 사용이 발생합니다.</li>
<li><strong>메모리 누수 가능성</strong>: 컴포넌트가 언마운트되었을 때 진행 중이던 검증 작업들이 적절히 정리되지 않으면 메모리 누수로 이어질 수 있습니다.</li>
</ul>
<p>이러한 문제를 해결하기 위해 lodash의 debounce 함수를 활용하여 다음과 같이 구현했습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> debouncedValidate = <span class="title function_">useMemo</span>(</span><br><span class="line">  <span class="function">() =&gt;</span></span><br><span class="line">    <span class="title function_">debounce</span>(<span class="function">(<span class="params">newValue: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 빈 값 체크는 즉시 수행</span></span><br><span class="line">      <span class="keyword">if</span> (!newValue) &#123;</span><br><span class="line">        <span class="title function_">setIsValid</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="comment">// 실제 유효성 검증은 지연 수행</span></span><br><span class="line">      <span class="keyword">const</span> validationResult = <span class="title function_">validate</span>(&#123; name, <span class="attr">value</span>: newValue, password &#125;);</span><br><span class="line">      <span class="title function_">setIsValid</span>(validationResult);</span><br><span class="line">    &#125;, <span class="number">250</span>),</span><br><span class="line">  [name, password]</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 메모리 누수 방지를 위한 클린업</span></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    debouncedValidate.<span class="title function_">cancel</span>();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, [debouncedValidate]);</span><br></pre></td></tr></table></figure>

<h2 id="▫︎-Debounce-함수의-메모이제이션"><a href="#▫︎-Debounce-함수의-메모이제이션" class="headerlink" title="▫︎ Debounce 함수의 메모이제이션"></a>▫︎ Debounce 함수의 메모이제이션</h2><p>useMemo를 사용하여 debounce 함수를 메모이제이션한 이유는 다음과 같습니다.</p>
<ul>
<li>컴포넌트가 리렌더링될 때마다 새로운 debounce 함수가 생성되는 것을 방지합니다.</li>
<li>의존성 배열에 name과 password만 포함하여, 이 값들이 변경될 때만 새로운 함수가 생성되도록 합니다.</li>
<li>불필요한 메모리 사용을 줄이고 성능을 최적화할 수 있습니다.</li>
</ul>
<h2 id="▫︎-지연-시간의-설정"><a href="#▫︎-지연-시간의-설정" class="headerlink" title="▫︎ 지연 시간의 설정"></a>▫︎ <strong>지연 시간의 설정</strong></h2><p>250밀리초의 지연 시간을 설정한 이유는 다음과 같습니다.</p>
<ul>
<li>사용자의 타이핑 속도를 고려하여 적절한 대기 시간을 설정했습니다.</li>
<li>너무 짧으면 debounce의 효과가 미미하고, 너무 길면 사용자가 답답함을 느낄 수 있습니다.</li>
<li>실제 사용자 테스트를 통해 최적의 시간을 도출했습니다.</li>
</ul>
<h2 id="▫︎-메모리-누수-방지"><a href="#▫︎-메모리-누수-방지" class="headerlink" title="▫︎ 메모리 누수 방지"></a>▫︎ <strong>메모리 누수 방지</strong></h2><p>클린업 함수를 구현한 이유와 그 중요성.</p>
<ul>
<li>컴포넌트가 언마운트될 때 진행 중인 모든 debounce 작업을 취소합니다.</li>
<li>이는 메모리 누수를 방지하고 예기치 않은 상태 업데이트를 막아줍니다.</li>
<li>React의 Strict Mode에서도 안정적으로 동작하도록 보장합니다.</li>
</ul>
<h1 id="▪︎-최적화의-효과"><a href="#▪︎-최적화의-효과" class="headerlink" title="▪︎ 최적화의 효과"></a>▪︎ <strong>최적화의 효과</strong></h1><p>최적화 이전과 이후를 비교하기 위해 chrome dev tools의 performance 탭과 memory 탭을 활용하였습니다.</p>
<p><img src="https://velog.velcdn.com/images/vbghdl/post/daabc03d-a451-49ab-ba8c-b96042502093/image.png" alt="image.png"></p>
<h2 id="▫︎-테스트-시나리오"><a href="#▫︎-테스트-시나리오" class="headerlink" title="▫︎ 테스트 시나리오"></a>▫︎ 테스트 시나리오</h2><p>다음과 같은 상황에서 메모리 사용량을 측정했습니다.</p>
<ol>
<li>이메일 입력 필드에 지정된 문자열을 250ms 이상의 속도로 빠르게 입력</li>
<li>5초 동안 대기</li>
<li>컴포넌트 언마운트</li>
</ol>
<h2 id="▫︎-측정-결과"><a href="#▫︎-측정-결과" class="headerlink" title="▫︎ 측정 결과"></a>▫︎ 측정 결과</h2><h3 id="Debounce-적용-시"><a href="#Debounce-적용-시" class="headerlink" title="Debounce 적용 시"></a>Debounce 적용 시</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Debounce 없이 직접 검증</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleChange</span> = (<span class="params">e: React.ChangeEvent&lt;HTMLInputElement&gt;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> newValue = e.<span class="property">target</span>.<span class="property">value</span>;</span><br><span class="line">  <span class="title function_">setValue</span>(newValue);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> validationResult = <span class="title function_">validate</span>(&#123;</span><br><span class="line">    name,</span><br><span class="line">    <span class="attr">value</span>: newValue,</span><br><span class="line">    password,</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="title function_">setIsValid</span>(validationResult);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li>초기 메모리: 24MB</li>
<li>입력 중 최대 메모리: 32MB</li>
<li>언마운트 후 메모리: 28MB (메모리 누수 발생)</li>
<li>검증 함수 호출 횟수: 16회 (“<a href="mailto:&#116;&#x65;&#x73;&#x74;&#64;&#x65;&#x78;&#97;&#x6d;&#112;&#x6c;&#101;&#x2e;&#x63;&#x6f;&#x6d;">&#116;&#x65;&#x73;&#x74;&#64;&#x65;&#x78;&#97;&#x6d;&#112;&#x6c;&#101;&#x2e;&#x63;&#x6f;&#x6d;</a>“ 입력 시)</li>
</ul>
<h3 id="Debounce-미-적용-시"><a href="#Debounce-미-적용-시" class="headerlink" title="Debounce 미 적용 시"></a>Debounce 미 적용 시</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> debouncedValidate = <span class="title function_">useMemo</span>(</span><br><span class="line">  <span class="function">() =&gt;</span></span><br><span class="line">    <span class="title function_">debounce</span>(<span class="function">(<span class="params">newValue: <span class="built_in">string</span></span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!newValue) &#123;</span><br><span class="line">        <span class="title function_">setIsValid</span>(<span class="literal">null</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">const</span> validationResult = <span class="title function_">validate</span>(&#123; name, <span class="attr">value</span>: newValue, password &#125;);</span><br><span class="line">      <span class="title function_">setIsValid</span>(validationResult);</span><br><span class="line">    &#125;, <span class="number">250</span>),</span><br><span class="line">  [name, password]</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    debouncedValidate.<span class="title function_">cancel</span>();</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;, [debouncedValidate]);</span><br></pre></td></tr></table></figure>

<ul>
<li>초기 메모리: 24MB</li>
<li>입력 중 최대 메모리: 27MB</li>
<li>언마운트 후 메모리: 24MB (초기 상태로 복귀)</li>
<li>검증 함수 호출 횟수: 1회 (“<a href="mailto:&#116;&#x65;&#x73;&#116;&#x40;&#x65;&#x78;&#97;&#x6d;&#x70;&#x6c;&#101;&#x2e;&#x63;&#x6f;&#109;">&#116;&#x65;&#x73;&#116;&#x40;&#x65;&#x78;&#97;&#x6d;&#x70;&#x6c;&#101;&#x2e;&#x63;&#x6f;&#109;</a>“ 입력 시)</li>
</ul>
<h3 id="메모리-패턴"><a href="#메모리-패턴" class="headerlink" title="메모리 패턴"></a>메모리 패턴</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 메모리 사용량 그래프 (시간에 따른 변화)</span><br><span class="line">/*</span><br><span class="line">Debounce 미적용:</span><br><span class="line">     32MB ┌─────┐</span><br><span class="line">     28MB │     └───────</span><br><span class="line">     24MB └─────────────</span><br><span class="line"></span><br><span class="line">Debounce 적용:</span><br><span class="line">     27MB ┌─┐</span><br><span class="line">     24MB └─└───────────</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<p>주요 차이점:</p>
<ul>
<li><strong>최대 메모리 사용량</strong>: Debounce를 적용했을 때 약 16% 낮은 최대 메모리 사용량을 보였습니다.</li>
<li><strong>메모리 해제</strong>: Debounce 적용 시 컴포넌트 언마운트 후 메모리가 완전히 해제되었습니다.</li>
<li><strong>메모리 변동폭</strong>: Debounce 적용 시 메모리 사용량의 변동폭이 더 작았습니다.</li>
</ul>
<h3 id="CPU-사용량"><a href="#CPU-사용량" class="headerlink" title="CPU 사용량"></a>CPU 사용량</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// CPU 사용량 비교</span><br><span class="line">/*</span><br><span class="line">Debounce 미적용:</span><br><span class="line">- 입력 중 CPU 사용: 평균 15%</span><br><span class="line">- 검증 함수 실행 시 스파이크: 최대 25%</span><br><span class="line"></span><br><span class="line">Debounce 적용:</span><br><span class="line">- 입력 중 CPU 사용: 평균 5%</span><br><span class="line">- 검증 함수 실행 시 스파이크: 최대 8%</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<h3 id="가비지-컬렉션-GC-패턴"><a href="#가비지-컬렉션-GC-패턴" class="headerlink" title="가비지 컬렉션 (GC) 패턴"></a>가비지 컬렉션 (GC) 패턴</h3><ul>
<li><strong>Debounce 미적용</strong>: 잦은 GC 발생 (초당 약 2-3회)</li>
<li><strong>Debounce 적용</strong>: GC 발생 빈도 감소 (초당 약 0.5회)</li>
</ul>
<h1 id="▪︎-최적화-의의"><a href="#▪︎-최적화-의의" class="headerlink" title="▪︎ 최적화 의의"></a>▪︎ 최적화 의의</h1><ol>
<li><strong>사용자 경험 개선</strong><ul>
<li>입력 지연 감소</li>
<li>브라우저 반응성 향상</li>
<li>배터리 사용량 감소 (모바일 환경)</li>
</ul>
</li>
<li><strong>서버 리소스 절약</strong><ul>
<li>API 호출이 포함된 검증의 경우, 서버 부하 감소</li>
<li>네트워크 트래픽 감소</li>
</ul>
</li>
<li><strong>장기적 안정성</strong><ul>
<li>메모리 누수 방지로 인한 안정적인 장시간 사용</li>
<li>예측 가능한 리소스 사용 패턴</li>
</ul>
</li>
</ol>
<p>이러한 측정 결과를 통해 Debounce 적용이 단순한 최적화를 넘어서, 애플리케이션의 전반적인 성능과 안정성 향상에 큰 영향을 미친다는 것을 확인할 수 있었습니다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://namgungjongmin.github.io/2025/01/13/project/wego/modal/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
      <meta itemprop="name" content="Namgung Jong Min">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/13/project/wego/modal/" class="post-title-link" itemprop="url">WEGO ) Zustand를 활용한 재사용 가능한 모달 시스템 구현</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-01-13 21:12:47" itemprop="dateCreated datePublished" datetime="2025-01-13T21:12:47+09:00">2025-01-13</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2025/01/13/project/wego/modal/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/01/13/project/wego/modal/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://velog.velcdn.com/images/vbghdl/post/921dd816-acad-468d-b160-8e912a3d9f5f/image.png"></p>
<blockquote>
<p>Next.js 프로젝트에서 모달을 효율적으로 관리하고 재사용 가능한 시스템을 구축하기 위해 <code>Zustand</code>를 사용하여 <strong>전역 상태 관리</strong>와 <strong>커스텀 훅을 통한 편리한 모달 호출 인터페이스</strong>를 작성하였습니다.</p>
</blockquote>
<h1 id="▪︎-주요-기능"><a href="#▪︎-주요-기능" class="headerlink" title="▪︎ 주요 기능"></a>▪︎ 주요 기능</h1><ul>
<li>전역 모달 상태 관리 ( Zustand )</li>
<li>텍스트 하이라이팅 기능</li>
<li>아이콘 커스터마이징</li>
<li>확인&#x2F;취소 버튼 커스터마이징</li>
<li>콜백함수 지원</li>
</ul>
<h1 id="▪︎-구현-상세"><a href="#▪︎-구현-상세" class="headerlink" title="▪︎ 구현 상세"></a>▪︎ 구현 상세</h1><h2 id="▫︎-Modal-Store"><a href="#▫︎-Modal-Store" class="headerlink" title="▫︎ Modal Store"></a>▫︎ Modal Store</h2><p>zustand를 사용하여 모달의 상태를 전역적으로 관리하였습니다. 텍스트 하이라이팅, 아이콘, 버튼 텍스트, 콜백 함수 등 다양한 커스터마이징 옵션 제공이 가능합니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// useModalStore.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">TextHighlight</span> &#123;</span><br><span class="line">  <span class="attr">range</span>: &#123;</span><br><span class="line">    <span class="attr">start</span>: <span class="built_in">number</span>;</span><br><span class="line">    <span class="attr">end</span>: <span class="built_in">number</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="attr">color</span>: <span class="built_in">string</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ModalState</span> &#123;</span><br><span class="line">  <span class="attr">isOpen</span>: <span class="built_in">boolean</span>;</span><br><span class="line">  icon?: <span class="title class_">ComponentType</span>;</span><br><span class="line">  <span class="attr">title</span>: <span class="built_in">string</span>;</span><br><span class="line">  titleHighlight?: <span class="title class_">TextHighlight</span>;</span><br><span class="line">  <span class="attr">message</span>: <span class="built_in">string</span>;</span><br><span class="line">  messageHighlight?: <span class="title class_">TextHighlight</span>;</span><br><span class="line">  <span class="attr">confirmText</span>: <span class="built_in">string</span>;</span><br><span class="line">  cancelText?: <span class="built_in">string</span>;</span><br><span class="line">  onConfirm?: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">  onCancel?: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title class_">ModalStore</span> &#123;</span><br><span class="line">  <span class="attr">modal</span>: <span class="title class_">ModalState</span>;</span><br><span class="line">  <span class="attr">openModal</span>: <span class="function">(<span class="params">modal: Partial&lt;ModalState&gt;</span>) =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">  <span class="attr">closeModal</span>: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="attr">initialState</span>: <span class="title class_">ModalState</span> = &#123;</span><br><span class="line">  <span class="attr">isOpen</span>: <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">title</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">message</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">confirmText</span>: <span class="string">&quot;확인&quot;</span>,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> useModalStore = create&lt;<span class="title class_">ModalStore</span>&gt;(<span class="function">(<span class="params">set</span>) =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">modal</span>: initialState,</span><br><span class="line">  <span class="attr">openModal</span>: <span class="function">(<span class="params">modal</span>) =&gt;</span></span><br><span class="line">    <span class="title function_">set</span>(<span class="function">(<span class="params">state</span>) =&gt;</span> (&#123;</span><br><span class="line">      <span class="attr">modal</span>: &#123; ...state.<span class="property">modal</span>, ...modal, <span class="attr">isOpen</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">    &#125;)),</span><br><span class="line">  <span class="attr">closeModal</span>: <span class="function">() =&gt;</span> <span class="title function_">set</span>(&#123; <span class="attr">modal</span>: initialState &#125;),</span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> &#123; useModalStore, <span class="keyword">type</span> <span class="title class_">TextHighlight</span> &#125;;</span><br></pre></td></tr></table></figure>

<h2 id="▫︎-Modal-Component"><a href="#▫︎-Modal-Component" class="headerlink" title="▫︎ Modal Component"></a>▫︎ Modal Component</h2><p>실제 화면에 그려질 컴포넌트입니다. 텍스트 하이라이팅 기능에 대해 어떻게 구현할지가 최대 고민거리였습니다.</p>
<p><img src="https://velog.velcdn.com/images/vbghdl/post/3a26c2b9-7dc1-4073-b726-d89f1facdb66/image.png" alt="image.png"></p>
<p>위 이미지처럼 Title과 message 들 중 텍스트에 색상으로 하이라이트가 들어가 있는 경우가 있었습니다. 어떤 식으로 인자를 받아야 해당 부분을 구현할 수 있을까 고민하다 하이라이팅 할 텍스트의 시작점과 끝점에 대한 정보와 color 정보를 받아 구현하도록 하였습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">HighlightedText</span> = (<span class="params">&#123; text, highlight &#125;: &#123; text: <span class="built_in">string</span>; highlight?: TextHighlight &#125;</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">if</span> (!highlight) <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;whitespace-pre-line&quot;</span>&gt;</span>&#123;text&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&quot;whitespace-pre-line&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;text.slice(0, highlight.range.start)&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">span</span> <span class="attr">className</span>=<span class="string">&#123;highlight.color&#125;</span>&gt;</span>&#123;text.slice(highlight.range.start, highlight.range.end)&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      &#123;text.slice(highlight.range.end)&#125;</span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>모달 컴포넌트의 코드는 다음과 같습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Modal.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">Modal</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; modal, closeModal &#125; = <span class="title function_">useModalStore</span>();</span><br><span class="line">  <span class="keyword">const</span> &#123;</span><br><span class="line">    isOpen,</span><br><span class="line">    <span class="attr">icon</span>: <span class="title class_">Icon</span>,</span><br><span class="line">    title,</span><br><span class="line">    titleHighlight,</span><br><span class="line">    message,</span><br><span class="line">    messageHighlight,</span><br><span class="line">    confirmText = <span class="string">&quot;확인&quot;</span>,</span><br><span class="line">    cancelText = <span class="string">&quot;취소&quot;</span>,</span><br><span class="line">    onConfirm,</span><br><span class="line">    onCancel,</span><br><span class="line">  &#125; = modal;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleConfirm</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (onConfirm) <span class="title function_">onConfirm</span>();</span><br><span class="line">    <span class="title function_">closeModal</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">handleCancel</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    <span class="keyword">if</span> (onCancel) <span class="title function_">onCancel</span>();</span><br><span class="line">    <span class="title function_">closeModal</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!isOpen) <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;fixed inset-0 z-50 flex animate-fade-in items-center justify-center bg-black/40 pb-[80px]&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;min-w-[298px] animate-slide-up rounded-lg bg-white p-8 md:min-w-[380px]&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;Icon &amp;&amp; (</span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;mb-4 flex justify-center&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;bg-primary-light flex h-16 w-16 items-center justify-center rounded-full&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Icon</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        )&#125;</span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;text-center&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">h2</span> <span class="attr">className</span>=<span class="string">&quot;title-5-b&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">HighlightedText</span> <span class="attr">text</span>=<span class="string">&#123;title&#125;</span> <span class="attr">highlight</span>=<span class="string">&#123;titleHighlight&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;<span class="name">p</span> <span class="attr">className</span>=<span class="string">&quot;text-body-2-r mt-2 whitespace-pre-line text-label-neutral&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">HighlightedText</span> <span class="attr">text</span>=<span class="string">&#123;message&#125;</span> <span class="attr">highlight</span>=<span class="string">&#123;messageHighlight&#125;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">          <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;mt-6 flex w-full justify-center&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          &#123;onCancel ? (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">className</span>=<span class="string">&quot;flex w-[250px] gap-2&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">label</span>=<span class="string">&#123;cancelText&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">size</span>=<span class="string">&quot;full&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">handler</span>=<span class="string">&#123;handleCancel&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">fill</span>=<span class="string">&quot;white&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">                <span class="attr">className</span>=<span class="string">&quot;h-[38px] w-[120px]&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              /&gt;</span></span></span><br><span class="line"><span class="language-xml">              <span class="tag">&lt;<span class="name">Button</span> <span class="attr">label</span>=<span class="string">&#123;confirmText&#125;</span> <span class="attr">size</span>=<span class="string">&quot;full&quot;</span> <span class="attr">handler</span>=<span class="string">&#123;handleConfirm&#125;</span> <span class="attr">className</span>=<span class="string">&quot;h-[38px] w-[120px]&quot;</span> /&gt;</span></span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">          ) : (</span></span><br><span class="line"><span class="language-xml">            <span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">label</span>=<span class="string">&#123;confirmText&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">size</span>=<span class="string">&quot;addon&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">handler</span>=<span class="string">&#123;handleConfirm&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">              <span class="attr">className</span>=<span class="string">&quot;h-[38px] w-[120px] md:w-[210px]&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">            /&gt;</span></span></span><br><span class="line"><span class="language-xml">          )&#125;</span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line">  );</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">Modal</span>;</span><br></pre></td></tr></table></figure>

<h2 id="▫︎-Modal-Custom-Hook"><a href="#▫︎-Modal-Custom-Hook" class="headerlink" title="▫︎ Modal Custom Hook"></a>▫︎ Modal Custom Hook</h2><p>간편한 모달 호출을 위해서 인터페이스를 제공하기 위해 커스텀 훅을 작성해주었습니다. 이제는 어디서든 이 커스텀 훅을 필요한 정보와 함께 호출하면 모달 사용이 가능해집니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">interface</span> <span class="title class_">ModalOptions</span> &#123;</span><br><span class="line">  icon?: <span class="title class_">ComponentType</span>&lt;<span class="title class_">SVGProps</span>&lt;<span class="title class_">SVGElement</span>&gt;&gt;;</span><br><span class="line">  titleHighlight?: <span class="title class_">TextHighlight</span>;</span><br><span class="line">  messageHighlight?: <span class="title class_">TextHighlight</span>;</span><br><span class="line">  confirmText?: <span class="built_in">string</span>;</span><br><span class="line">  cancelText?: <span class="built_in">string</span>;</span><br><span class="line">  onConfirm?: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">  onCancel?: <span class="function">() =&gt;</span> <span class="built_in">void</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useModal</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> &#123; openModal, closeModal &#125; = <span class="title function_">useModalStore</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">showModal</span> = (<span class="params">title: <span class="built_in">string</span>, message: <span class="built_in">string</span>, options?: ModalOptions</span>) =&gt; &#123;</span><br><span class="line">    <span class="title function_">openModal</span>(&#123;</span><br><span class="line">      title,</span><br><span class="line">      message,</span><br><span class="line">      ...options,</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    showModal,</span><br><span class="line">    closeModal,</span><br><span class="line">  &#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> useModal;</span><br></pre></td></tr></table></figure>

<h1 id="▪︎-사용-예시"><a href="#▪︎-사용-예시" class="headerlink" title="▪︎ 사용 예시"></a>▪︎ 사용 예시</h1><p>프로젝트 내 동일한 형식의 모달이 필요한 곳에서는 모달 커스텀 훅을 호출하여 편리하게 사용이 가능했습니다. 예시 코드는 TanstackQuery의 useMutation 훅으로 작성된 회원가입 api 가 성공했을 시, 모달이 보여지게 동작합니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// useSignup.ts</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">useSignup</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> router = <span class="title function_">useRouter</span>();</span><br><span class="line">  <span class="keyword">const</span> &#123; showModal &#125; = <span class="title function_">useModal</span>();</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">useMutation</span>(&#123;</span><br><span class="line">    <span class="attr">mutationFn</span>: signup,</span><br><span class="line">    <span class="attr">onError</span>: <span class="function">(<span class="params">error: QueryError</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">switch</span> (error.<span class="property">status</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">500</span>:</span><br><span class="line">          <span class="title function_">showModal</span>(<span class="string">&quot;네트워크를 확인해주세요.&quot;</span>, <span class="string">&quot;회원가입에 실패했습니다.&quot;</span>, &#123;</span><br><span class="line">            <span class="attr">icon</span>: <span class="title class_">ModalErrorIcon</span>,</span><br><span class="line">            <span class="attr">confirmText</span>: <span class="string">&quot;돌아가기&quot;</span>,</span><br><span class="line">            <span class="attr">messageHighlight</span>: &#123;</span><br><span class="line">              <span class="attr">range</span>: &#123; <span class="attr">start</span>: <span class="number">6</span>, <span class="attr">end</span>: <span class="number">8</span> &#125;,</span><br><span class="line">              <span class="attr">color</span>: <span class="string">&quot;text-status-error&quot;</span>,</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">onConfirm</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">              router.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;);</span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">400</span>:</span><br><span class="line">          <span class="comment">// 400 에러 핸들링</span></span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">        <span class="comment">// default 에러 핸들링</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">onSuccess</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="title function_">showModal</span>(<span class="string">&quot;축하해요! WE&#x27;GO의\n회원가입이 완료 되었습니다.&quot;</span>, <span class="string">&quot;이제 함께 떠나는 여행을 시작해요.&quot;</span>, &#123;</span><br><span class="line">        <span class="attr">icon</span>: <span class="title class_">ModalSuccessIcon</span>,</span><br><span class="line">        <span class="attr">confirmText</span>: <span class="string">&quot;확인&quot;</span>,</span><br><span class="line">        <span class="attr">titleHighlight</span>: &#123;</span><br><span class="line">          <span class="attr">range</span>: &#123; <span class="attr">start</span>: <span class="number">19</span>, <span class="attr">end</span>: <span class="number">21</span> &#125;,</span><br><span class="line">          <span class="attr">color</span>: <span class="string">&quot;text-primary-normal&quot;</span>,</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">onConfirm</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">          router.<span class="title function_">push</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h1 id="▪︎-구현-방식의-장점"><a href="#▪︎-구현-방식의-장점" class="headerlink" title="▪︎ 구현 방식의 장점"></a>▪︎ 구현 방식의 장점</h1><h3 id="1-재사용성"><a href="#1-재사용성" class="headerlink" title="1. 재사용성"></a>1. 재사용성</h3><p>프로젝트 전체에서 일관된 모달 UI&#x2F;UX 제공</p>
<h3 id="2-타입-안정성"><a href="#2-타입-안정성" class="headerlink" title="2. 타입 안정성"></a>2. 타입 안정성</h3><p><code>TypeScript</code>를 활용한 완벽한 타입 지원</p>
<h3 id="3-커스터마이징"><a href="#3-커스터마이징" class="headerlink" title="3. 커스터마이징"></a>3. 커스터마이징</h3><p>다양한 옵션으로 상황에 맞는 모달 구성 가능</p>
<h3 id="4-사용-편의성"><a href="#4-사용-편의성" class="headerlink" title="4. 사용 편의성"></a>4. 사용 편의성</h3><p>간단한 인터페이스로 복잡한 모달 구현 가능</p>
<h1 id="▪︎-마치며"><a href="#▪︎-마치며" class="headerlink" title="▪︎ 마치며"></a>▪︎ 마치며</h1><p><code>Zustand</code>와 <code>Custom Hook</code>을 활용하여 재사용 가능하고 타입 안전한 모달 시스템을 구축했습니다. 이를 통해 프로젝트의 일관성을 유지하면서도 다양한 상황에 대응할 수 있는 유연한 모달 구현이 가능했습니다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://namgungjongmin.github.io/2025/01/11/project/wego/cn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
      <meta itemprop="name" content="Namgung Jong Min">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/11/project/wego/cn/" class="post-title-link" itemprop="url">WEGO ) Tailwind CSS로 확장성과 재사용성을 고려한 공통 컴포넌트 설계하기</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-01-11 17:32:17" itemprop="dateCreated datePublished" datetime="2025-01-11T17:32:17+09:00">2025-01-11</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2025/01/11/project/wego/cn/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/01/11/project/wego/cn/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://velog.velcdn.com/images/vbghdl/post/921dd816-acad-468d-b160-8e912a3d9f5f/image.png"></p>
<blockquote>
<p>프로젝트를 진행하면서 버튼 컴포넌트와 같은 공통 컴포넌트를 설계할 때, 확장성과 재사용성을 최우선으로 고려했습니다. 이를 위해 cva, clsx, tailwind-merge라는 세 가지 라이브러리를 조합하여 사용했는데요, 이번 글에서는 각 라이브러리의 특징과 이들을 조합했을 때의 시너지에 대해 공유하고자 합니다.</p>
</blockquote>
<h1 id="▪︎-각-라이브러리의-특징과-역할"><a href="#▪︎-각-라이브러리의-특징과-역할" class="headerlink" title="▪︎ 각 라이브러리의 특징과 역할"></a>▪︎ 각 <strong>라이브러리의 특징과 역할</strong></h1><h2 id="▫︎-CVA-Class-Variance-Authority"><a href="#▫︎-CVA-Class-Variance-Authority" class="headerlink" title="▫︎ CVA (Class Variance Authority)"></a>▫︎ <strong>CVA (Class Variance Authority)</strong></h2><p>Class Variance Authority(CVA)는 컴포넌트의 다양한 스타일 변형(variants)을 타입 안전하게 관리할 수 있게 해주는 라이브러리입니다. 특히 Tailwind CSS와 함께 사용할 때 그 진가를 발휘하는데, 이는 미리 정의된 스타일 조합을 타입 시스템의 보호 아래 안전하게 사용할 수 있게 해줍니다.</p>
<p>우리 프로젝트의 버튼 컴포넌트에는 다음과 같이 variants를 정의해 사용하였습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">ButtonVariants</span> = <span class="title function_">cva</span>(</span><br><span class="line">  <span class="comment">// 기본 스타일</span></span><br><span class="line">  <span class="string">&quot;body-1-m rounded disabled:border disabled:border-line-normal disabled:bg-background-alternative disabled:text-label-alternative flex items-center justify-center&quot;</span>,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">variants</span>: &#123;</span><br><span class="line">      <span class="attr">fill</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="string">&quot;bg-label-normal text-white&quot;</span>,</span><br><span class="line">        <span class="attr">white</span>: <span class="string">&quot;bg-white border border-line-strong text-line-strong&quot;</span>,</span><br><span class="line">        <span class="attr">blue</span>: <span class="string">&quot;bg-primary-normal text-white hover:text-primary-normal hover:bg-blue-100&quot;</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">size</span>: &#123;</span><br><span class="line">        <span class="attr">default</span>: <span class="string">&quot;w-[335px] h-[52px]&quot;</span>,</span><br><span class="line">        <span class="attr">full</span>: <span class="string">&quot;w-full h-[52px]&quot;</span>,</span><br><span class="line">        <span class="comment">// ... 기타 사이즈 variants</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="comment">// ... 기타 variant 그룹들</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">defaultVariants</span>: &#123;</span><br><span class="line">      <span class="attr">fill</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="attr">size</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">      <span class="attr">font</span>: <span class="string">&quot;default&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>이러한 CVA의 사용은 다음과 같은 구체적인 이점을 제공합니다.</p>
<ol>
<li><strong>타입 안전성</strong>: TypeScript와 완벽하게 통합되어, 정의되지 않은 variant 조합을 사용하려 할 때 컴파일 단계에서 오류를 발견할 수 있습니다. 예를 들어, fill&#x3D;”invalid”와 같은 잘못된 값을 사용하려 하면 즉시 TypeScript 에러가 발생합니다.</li>
<li><strong>중앙 집중화된 스타일 관리</strong>: 모든 스타일 variant를 한 파일에서 관리함으로써, 디자인 시스템의 일관성을 유지하기가 훨씬 쉬워집니다. 스타일 수정이 필요할 때도 한 곳만 수정하면 되므로 유지보수가 용이합니다.</li>
<li><strong>자동 완성 지원</strong>: IDE에서 사용 가능한 variant 옵션들을 자동으로 제안받을 수 있어, 개발 생산성이 크게 향상됩니다.</li>
</ol>
<h2 id="▫︎-CLSX"><a href="#▫︎-CLSX" class="headerlink" title="▫︎ CLSX"></a>▫︎ <strong>CLSX</strong></h2><p>CLSX는 조건부 클래스명을 처리하기 위한 유틸리티 라이브러리입니다. 특히 React 컴포넌트에서 동적인 클래스명을 다룰 때 매우 유용합니다. 이 라이브러리는 다양한 형태의 입력을 처리할 수 있으며, 최종적으로 유효한 클래스명 문자열을 생성해줍니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; clsx, <span class="title class_">ClassValue</span> &#125; <span class="keyword">from</span> <span class="string">&quot;clsx&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// clsx 사용 예시</span></span><br><span class="line"><span class="keyword">const</span> className = <span class="title function_">clsx</span>(<span class="string">&quot;base-class&quot;</span>, isActive &amp;&amp; <span class="string">&quot;active&quot;</span>, &#123; <span class="string">&quot;is-disabled&quot;</span>: isDisabled &#125;, [</span><br><span class="line">  <span class="string">&quot;additional-class-1&quot;</span>,</span><br><span class="line">  <span class="string">&quot;additional-class-2&quot;</span>,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>

<p>CLSX는 다음과 같은 강력한 기능들을 제공합니다.</p>
<ol>
<li><strong>다양한 입력 형식 지원</strong>: 문자열, 객체, 배열 등 어떤 형태로든 클래스명을 전달할 수 있습니다. 이는 다양한 상황에서 유연하게 클래스를 조합할 수 있게 해줍니다.</li>
<li><strong>자동 정리</strong>: falsy 값(undefined, null, false 등)을 자동으로 필터링하여 깨끗한 클래스명 문자열을 생성합니다.</li>
<li><strong>직관적인 문법</strong>: 복잡한 조건부 클래스 로직도 읽기 쉽고 이해하기 쉬운 형태로 작성할 수 있습니다.</li>
</ol>
<h2 id="▫︎-Tailwind-Merge"><a href="#▫︎-Tailwind-Merge" class="headerlink" title="▫︎ Tailwind Merge"></a>▫︎ <strong>Tailwind Merge</strong></h2><p>Tailwind Merge는 Tailwind CSS를 사용할 때 발생할 수 있는 클래스 충돌 문제를 우아하게 해결해주는 라이브러리입니다. 특히 재사용 가능한 컴포넌트를 만들 때 매우 유용한데, 이는 기본 스타일과 커스텀 스타일이 충돌할 때 가장 마지막에 선언된 스타일을 우선적으로 적용하는 방식으로 동작합니다.</p>
<p>Tailwind Merge를 통해 해결할 수 있는 실제 문제 상황을 예시로 살펴보겠습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Tailwind Merge 없이 사용할 경우</span></span><br><span class="line">&lt;button className=<span class="string">&quot;px-4 py-2 text-sm text-blue-500 px-6&quot;</span>&gt;</span><br><span class="line">  <span class="comment">// px-4와 px-6이 충돌, 브라우저 CSS 규칙에 따라 먼저 선언된 px-4가 적용됨</span></span><br><span class="line">&lt;/button&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Tailwind Merge 사용</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">button</span> <span class="attr">className</span>=<span class="string">&#123;twMerge(</span>&quot;<span class="attr">px-4</span> <span class="attr">py-2</span> <span class="attr">text-sm</span> <span class="attr">text-blue-500</span>&quot;, &quot;<span class="attr">px-6</span>&quot;)&#125;&gt;</span></span></span><br><span class="line"><span class="language-xml">  // 의도한 대로 px-6이 적용됨</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>Tailwind Merge는 다음과 같은 핵심적인 문제들을 해결합니다.</p>
<ol>
<li><strong>충돌 해결</strong>: 같은 속성을 가진 클래스들이 충돌할 때, 가장 마지막에 선언된 클래스를 우선적으로 적용합니다. 이는 CSS의 일반적인 캐스케이딩 규칙과도 일치하는 직관적인 동작입니다.</li>
<li><strong>최적화</strong>: 중복되거나 불필요한 클래스들을 자동으로 제거하여 최종적으로 깔끔한 클래스 문자열을 생성합니다.</li>
<li><strong>모든 Tailwind 규칙 지원</strong>: Tailwind CSS의 모든 유틸리티 클래스와 변형자(modifiers)를 완벽하게 이해하고 처리할 수 있습니다.</li>
</ol>
<h1 id="▪︎-세-라이브러리를-조합한-유틸함수-활용"><a href="#▪︎-세-라이브러리를-조합한-유틸함수-활용" class="headerlink" title="▪︎ 세 라이브러리를 조합한 유틸함수 활용"></a>▪︎ 세 라이브러리를 조합한 유틸함수 활용</h1><p>이 세 라이브러리를 조합하여 사용할 때 발생하는 시너지는 매우 강력합니다. 각각의 라이브러리가 가진 장점들이 서로를 보완하면서, 더욱 강력하고 유지보수하기 쉬운 컴포넌트 시스템을 구축할 수 있게 됩니다.</p>
<p>우리 프로젝트에 적용하기 위해 세 라이브러리를 조합한 유틸함수인 cn을 작성하였습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// cn.tsx</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123; twMerge &#125; <span class="keyword">from</span> <span class="string">&quot;tailwind-merge&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; clsx, <span class="title class_">ClassValue</span> &#125; <span class="keyword">from</span> <span class="string">&quot;clsx&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">cn</span> = (<span class="params">...inputs: ClassValue[]</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">twMerge</span>(<span class="title function_">clsx</span>(inputs));</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">/ <span class="title class_">Button</span>.<span class="property">tsx</span> (유틸 함수 활용한 공통 컴포넌트)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title class_">Button</span> = forwardRef&lt;<span class="title class_">HTMLButtonElement</span>, <span class="title class_">Props</span>&gt;(</span><br><span class="line">  <span class="function">(<span class="params">&#123;</span></span></span><br><span class="line"><span class="params"><span class="function">    fill,</span></span></span><br><span class="line"><span class="params"><span class="function">    size,</span></span></span><br><span class="line"><span class="params"><span class="function">    font,</span></span></span><br><span class="line"><span class="params"><span class="function">    hover,</span></span></span><br><span class="line"><span class="params"><span class="function">    hoverBorder,</span></span></span><br><span class="line"><span class="params"><span class="function">    className,</span></span></span><br><span class="line"><span class="params"><span class="function">    classNameCondition,</span></span></span><br><span class="line"><span class="params"><span class="function">    ...props</span></span></span><br><span class="line"><span class="params"><span class="function">  &#125;, ref</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      <span class="language-xml"><span class="tag">&lt;<span class="name">button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">className</span>=<span class="string">&#123;cn(</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">ButtonVariants</span>(&#123; <span class="attr">fill</span>, <span class="attr">size</span>, <span class="attr">font</span>, <span class="attr">hover</span>, <span class="attr">hoverBorder</span> &#125;),</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">className</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">          <span class="attr">classNameCondition</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        )&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        &#123;<span class="attr">...props</span>&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">        <span class="attr">ref</span>=<span class="string">&#123;ref&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">      &gt;</span></span></span><br><span class="line"><span class="language-xml">        &#123;/* 버튼 내용 */&#125;</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="1-개발-경험-향상"><a href="#1-개발-경험-향상" class="headerlink" title="1. 개발 경험 향상"></a><strong>1. 개발 경험 향상</strong></h3><ul>
<li><strong>타입 안전성</strong>: CVA를 통해 정의된 variants는 TypeScript의 타입 검사를 받게 되어, 잘못된 prop 사용을 방지할 수 있습니다.</li>
<li><strong>자동 완성</strong>: IDE에서 사용 가능한 모든 variant 옵션들을 자동으로 제안받을 수 있어 개발 속도가 향상됩니다.</li>
<li><strong>디버깅 용이성</strong>: 스타일 관련 문제가 발생했을 때, 문제의 원인을 쉽게 추적할 수 있습니다.</li>
</ul>
<h3 id="2-유지보수성-개선"><a href="#2-유지보수성-개선" class="headerlink" title="2. 유지보수성 개선"></a><strong>2. 유지보수성 개선</strong></h3><ul>
<li><strong>중앙 집중화된 스타일 관리</strong>: 모든 기본 스타일 변형이 한 곳에서 관리되어 일관성 유지가 쉽습니다.</li>
<li><strong>변경 용이성</strong>: 디자인 시스템의 변경이 필요할 때, variants 정의만 수정하면 되므로 변경 사항을 쉽게 적용할 수 있습니다.</li>
<li><strong>코드 재사용</strong>: 잘 정의된 variant 시스템으로 인해 동일한 스타일을 여러 곳에서 일관되게 사용할 수 있습니다.</li>
</ul>
<h3 id="3-확장성-확보"><a href="#3-확장성-확보" class="headerlink" title="3. 확장성 확보"></a><strong>3. 확장성 확보</strong></h3><ul>
<li><strong>커스텀 스타일링</strong>: className prop을 통해 기본 스타일을 확장하거나 재정의할 수 있습니다.</li>
<li><strong>조건부 스타일링</strong>: classNameCondition을 통해 특정 조건에 따른 스타일 적용이 가능합니다.</li>
<li><strong>새로운 변형 추가</strong>: 새로운 디자인 요구사항이 생겼을 때 variants에 쉽게 추가할 수 있습니다.</li>
</ul>
<h1 id="▪︎-컴포넌트-사용-예시"><a href="#▪︎-컴포넌트-사용-예시" class="headerlink" title="▪︎ 컴포넌트 사용 예시"></a>▪︎ 컴포넌트 사용 예시</h1><h2 id="▫︎-기본적인-사용-패턴"><a href="#▫︎-기본적인-사용-패턴" class="headerlink" title="▫︎ 기본적인 사용 패턴"></a>▫︎ 기본적인 사용 패턴</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 기본 버튼</span></span><br><span class="line">&lt;<span class="title class_">Button</span></span><br><span class="line">  fill=<span class="string">&quot;default&quot;</span></span><br><span class="line">  size=<span class="string">&quot;full&quot;</span></span><br><span class="line">  label=<span class="string">&quot;로그인&quot;</span></span><br><span class="line">/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 모달 내 버튼</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">fill</span>=<span class="string">&quot;white&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">size</span>=<span class="string">&quot;modal&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">label</span>=<span class="string">&quot;취소&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">/&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>이러한 기본 사용에서는 미리 정의된 variants를 통해 일관된 디자인을 유지하면서도, 각 상황에 맞는 적절한 스타일을 적용할 수 있습니다.</p>
<h2 id="▫︎-활용-패턴"><a href="#▫︎-활용-패턴" class="headerlink" title="▫︎ 활용 패턴"></a>▫︎ 활용 패턴</h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 동적 스타일링이 필요한 경우</span></span><br><span class="line">&lt;<span class="title class_">Button</span></span><br><span class="line">  fill=<span class="string">&quot;blue&quot;</span></span><br><span class="line">  size=<span class="string">&quot;modal&quot;</span></span><br><span class="line">  className=&#123;<span class="title function_">cn</span>(</span><br><span class="line">    <span class="string">&quot;mt-4&quot;</span>,</span><br><span class="line">    isSpecial &amp;&amp; <span class="string">&quot;border-2 border-primary-normal&quot;</span>,</span><br><span class="line">    isPriority ? <span class="string">&quot;shadow-lg&quot;</span> : <span class="string">&quot;shadow-sm&quot;</span></span><br><span class="line">  )&#125;</span><br><span class="line">  label=<span class="string">&quot;확인&quot;</span></span><br><span class="line">/&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 조건부 스타일링이 필요한 경우</span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">Button</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">fill</span>=<span class="string">&quot;white&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">size</span>=<span class="string">&quot;default&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">classNameCondition</span>=<span class="string">&#123;&#123;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &#x27;<span class="attr">opacity-50</span> <span class="attr">cursor-not-allowed</span>&#x27;<span class="attr">:</span> <span class="attr">isDisabled</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &#x27;<span class="attr">shadow-md</span>&#x27;<span class="attr">:</span> <span class="attr">isActive</span>,</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">    &#x27;<span class="attr">ring-2</span> <span class="attr">ring-primary-normal</span>&#x27;<span class="attr">:</span> <span class="attr">isFocused</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  &#125;&#125;</span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">label</span>=<span class="string">&quot;제출하기&quot;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">  <span class="attr">disabled</span>=<span class="string">&#123;isDisabled&#125;</span></span></span></span><br><span class="line"><span class="tag"><span class="language-xml">/&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>활용 패턴에서는 다음과 같은 이점을 얻을 수 있습니다.</p>
<ul>
<li>className을 통해 상황에 따른 추가적인 스타일을 적용할 수 있습니다.</li>
<li>classNameCondition을 사용하여 여러 조건에 따른 스타일 변화를 한 번에 관리할 수 있습니다.</li>
<li>기본 variants와 커스텀 스타일을 자연스럽게 조합할 수 있습니다.</li>
</ul>
<h1 id="▪︎-유지보수와-확장"><a href="#▪︎-유지보수와-확장" class="headerlink" title="▪︎ 유지보수와 확장"></a>▪︎ 유지보수와 확장</h1><p>이러한 설계는 장기적인 관점에서 큰 이점을 제공합니다.</p>
<h3 id="1-새로운-디자인-요구사항-대응"><a href="#1-새로운-디자인-요구사항-대응" class="headerlink" title="1. 새로운 디자인 요구사항 대응"></a>1. <strong>새로운 디자인 요구사항 대응</strong></h3><ul>
<li>새로운 variant를 추가하기 쉽습니다.</li>
<li>기존 스타일을 수정하더라도 타입 시스템이 변경이 필요한 곳을 알려줍니다.</li>
</ul>
<h3 id="2-일관성-유지"><a href="#2-일관성-유지" class="headerlink" title="2. 일관성 유지"></a><strong>2. 일관성 유지</strong></h3><ul>
<li>모든 버튼이 동일한 스타일 시스템을 따르게 됩니다.</li>
<li>디자인 토큰의 변경이 용이합니다.</li>
</ul>
<h3 id="3-팀-협업"><a href="#3-팀-협업" class="headerlink" title="3. 팀 협업"></a><strong>3. 팀 협업</strong></h3><ul>
<li>명확한 사용 방법과 타입 지원으로 다른 개발자들도 쉽게 사용할 수 있습니다.</li>
<li>문서화가 용이합니다.</li>
</ul>
<h1 id="▪︎-마치며"><a href="#▪︎-마치며" class="headerlink" title="▪︎ 마치며"></a>▪︎ 마치며</h1><p>이번 글에서는 CVA, CLSX, Tailwind Merge를 조합하여 어떻게 확장 가능하고 유지보수하기 좋은 버튼 컴포넌트를 구현했는지 살펴보았습니다. 이러한 설계 방식을 통해 얻은 주요 이점들을 정리해보면 다음과 같습니다:</p>
<h2 id="▫︎-실제-프로젝트에서의-효과"><a href="#▫︎-실제-프로젝트에서의-효과" class="headerlink" title="▫︎ 실제 프로젝트에서의 효과"></a><strong>▫︎ 실제 프로젝트에서의 효과</strong></h2><ol>
<li><strong>개발 생산성 향상</strong><ul>
<li>타입 시스템의 지원으로 실수를 사전에 방지할 수 있었습니다.</li>
<li>자동 완성 기능으로 개발 속도가 크게 향상되었습니다.</li>
<li>반복적인 스타일링 코드 작성이 줄어들었습니다.</li>
</ul>
</li>
<li><strong>디자인 시스템 일관성 확보</strong><ul>
<li>중앙에서 관리되는 스타일 variants로 인해 일관된 UI를 유지할 수 있었습니다.</li>
<li>디자인 변경 사항을 쉽게 적용할 수 있었습니다.</li>
<li>새로운 디자인 요구사항에도 유연하게 대응할 수 있었습니다.</li>
</ul>
</li>
<li><strong>코드 품질 향상</strong><ul>
<li>타입 안전성으로 인해 런타임 에러가 감소했습니다.</li>
<li>스타일 관련 버그를 쉽게 추적하고 해결할 수 있었습니다.</li>
<li>코드베이스가 커져도 유지보수가 어렵지 않았습니다.</li>
</ul>
</li>
</ol>
<p>이러한 접근 방식은 단순히 스타일링 문제를 해결하는 것을 넘어서, 확장 가능하고 유지보수하기 좋은 컴포넌트 시스템을 구축하는 데 큰 도움이 되었습니다. 특히 팀 단위의 개발에서 일관성을 유지하면서도 유연한 확장이 가능한 구조를 만들 수 있었다는 점에서 큰 의미가 있었습니다.</p>
<p>앞으로도 이러한 경험을 바탕으로, 더 나은 컴포넌트 시스템을 구축해 나가도록 하겠습니다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://namgungjongmin.github.io/2025/01/08/project/wego/%EB%AF%B8%EB%93%A4%EC%9B%A8%EC%96%B4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
      <meta itemprop="name" content="Namgung Jong Min">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/08/project/wego/%EB%AF%B8%EB%93%A4%EC%9B%A8%EC%96%B4/" class="post-title-link" itemprop="url">WEGO ) Next.js 미들웨어를 활용한 유저 인증 플로우 구현</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-01-08 23:12:21" itemprop="dateCreated datePublished" datetime="2025-01-08T23:12:21+09:00">2025-01-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2025/01/08/project/wego/%EB%AF%B8%EB%93%A4%EC%9B%A8%EC%96%B4/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/01/08/project/wego/미들웨어/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://velog.velcdn.com/images/vbghdl/post/921dd816-acad-468d-b160-8e912a3d9f5f/image.png"></p>
<blockquote>
<p>웹 애플리케이션에서 인증된 사용자와 비인증 사용자에 대한 페이지 접근 제어는 매우 중요합니다. 특히 사용자 경험(UX)을 해치지 않으면서 안전하게 구현하는 것이 핵심인데요. 이번 글에서는 Next.js의 미들웨어를 활용해 어떻게 더 나은 인증 플로우를 구현했는지 공유하고자 합니다.</p>
</blockquote>
<h1 id="▪︎-기존-인증-구현의-문제점"><a href="#▪︎-기존-인증-구현의-문제점" class="headerlink" title="▪︎ 기존 인증 구현의 문제점"></a>▪︎ <strong>기존 인증 구현의 문제점</strong></h1><p>유저의 인증 여부를 판단하기 위해 token 검증만을 위한 api를 백엔드 측에 요청했습니다. 백엔드 측에서는 요청의 쿠키에서 accessToken을 읽어 그 검증 여부에 따라 결과를 반환해줬습니다. 우리 프론트에서는 인가 필요 페이지에서 그 결과가 성공이면 페이지를 보여주고, 실패면 로그인 페이지로 리다이렉트 시키는 로직이 필요했습니다.</p>
<p>처음에는 컴포넌트 내부에서 api 요청을 하고 그 결과에 따라 리다이렉트 여부를 결정했습니다. 그러나 이 경우 api 요청에 대한 결과를 받는 동안 잠깐동안 페이지의 레이아웃이 보여지는 플리킹 현상이 발생했습니다. 추가로 각 컴포넌트마다 토큰 인증에 따른 리다이렉트 로직을 작성해주어야 했습니다.</p>
<h2 id="▫︎-깜빡임-현상-Flash-of-Unauthorized-Content"><a href="#▫︎-깜빡임-현상-Flash-of-Unauthorized-Content" class="headerlink" title="▫︎ 깜빡임 현상 (Flash of Unauthorized Content)"></a>▫︎ <strong>깜빡임 현상 (Flash of Unauthorized Content)</strong></h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 컴포넌트 내부에서 인증 체크 시 발생하는 문제</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">ProtectedPage</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">useEffect</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// 인증 체크 후 리다이렉트</span></span><br><span class="line">    <span class="keyword">if</span> (!isAuthenticated) &#123;</span><br><span class="line">      router.<span class="title function_">push</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;, []);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>보호된 콘텐츠<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span>; <span class="comment">// 잠깐 보였다가 사라짐</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="▫︎-중복-코드-발생"><a href="#▫︎-중복-코드-발생" class="headerlink" title="▫︎ 중복 코드 발생"></a>▫︎ <strong>중복 코드 발생</strong></h2><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 여러 서버 컴포넌트에서 반복되는 인증 체크 로직</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">Page1</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> isAuthenticated = <span class="keyword">await</span> <span class="title function_">checkAuth</span>();</span><br><span class="line">  <span class="keyword">if</span> (!isAuthenticated) &#123;</span><br><span class="line">    <span class="title function_">redirect</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">Page2</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> isAuthenticated = <span class="keyword">await</span> <span class="title function_">checkAuth</span>();</span><br><span class="line">  <span class="keyword">if</span> (!isAuthenticated) &#123;</span><br><span class="line">    <span class="title function_">redirect</span>(<span class="string">&quot;/login&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="▪︎-미들웨어를-활용한-해결-방안"><a href="#▪︎-미들웨어를-활용한-해결-방안" class="headerlink" title="▪︎ 미들웨어를 활용한 해결 방안"></a>▪︎ 미들웨어를 활용한 해결 방안</h1><h2 id="▫︎-중앙-집중화된-인증-로직"><a href="#▫︎-중앙-집중화된-인증-로직" class="headerlink" title="▫︎ 중앙 집중화된 인증 로직"></a>▫︎ <strong>중앙 집중화된 인증 로직</strong></h2><p>미들웨어의 가장 큰 장점은 모든 페이지 요청에 대해 선제적으로 실행된다는 점입니다. 이를 활용하여 인증 로직을 중앙에서 관리할 수 있습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// middleware.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">middleware</span> = (<span class="params">request: NextRequest</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 정적 파일 요청은 미들웨어 처리하지 않음</span></span><br><span class="line">  <span class="keyword">if</span> (</span><br><span class="line">    request.<span class="property">nextUrl</span>.<span class="property">pathname</span>.<span class="title function_">startsWith</span>(<span class="string">&quot;/_next&quot;</span>) ||</span><br><span class="line">    request.<span class="property">nextUrl</span>.<span class="property">pathname</span>.<span class="title function_">includes</span>(<span class="string">&quot;/api/&quot;</span>) ||</span><br><span class="line">    request.<span class="property">nextUrl</span>.<span class="property">pathname</span>.<span class="title function_">match</span>(<span class="regexp">/\.(ico|png|svg|jpg|jpeg|gif)$/</span>)</span><br><span class="line">  ) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">next</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> response = <span class="title class_">NextResponse</span>.<span class="title function_">next</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 로그인 여부에 따라 리다이렉트</span></span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">authRedirect</span>(request, response);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>여기서 주목할 점은 다음과 같습니다.</p>
<ul>
<li><strong>성능 최적화</strong>: 정적 파일에 대한 요청은 미들웨어를 거치지 않도록 처리했습니다. 이는 불필요한 인증 검사를 줄여 성능을 향상시킵니다.</li>
<li><strong>확장성</strong>: authRedirect 함수를 별도로 분리하여, 추후 인증 로직이 변경되거나 추가되어도 유연하게 대응할 수 있습니다.</li>
<li><strong>유지보수성</strong>: 인증 관련 로직이 한 곳에 집중되어 있어, 변경이 필요할 때 이 파일만 수정하면 됩니다.</li>
</ul>
<h2 id="▫︎-환경별-토큰-검증-전략"><a href="#▫︎-환경별-토큰-검증-전략" class="headerlink" title="▫︎ 환경별 토큰 검증 전략"></a>▫︎ <strong>환경별 토큰 검증 전략</strong></h2><p>개발 환경과 프로덕션 환경에서의 토큰 검증 방식을 분리하여 관리했습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">authRedirect</span> = <span class="keyword">async</span> (<span class="params">request: NextRequest, response: NextResponse</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> verifyResponse =</span><br><span class="line">    process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;development&quot;</span> ? <span class="keyword">await</span> <span class="title function_">verifyTokenMock</span>(request) : <span class="keyword">await</span> <span class="title function_">verifyToken</span>(request);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 토큰 유효성 검증이 필요한 페이지 처리</span></span><br><span class="line">  <span class="keyword">if</span> ((<span class="title class_">Object</span>.<span class="title function_">values</span>(<span class="variable constant_">NEED_LOGIN_PATH</span>) <span class="keyword">as</span> <span class="built_in">string</span>[]).<span class="title function_">includes</span>(request.<span class="property">nextUrl</span>.<span class="property">pathname</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (verifyResponse.<span class="property">status</span> === <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> loginUrl = <span class="keyword">new</span> <span class="title function_">URL</span>(<span class="string">&quot;/login&quot;</span>, request.<span class="property">nextUrl</span>.<span class="property">origin</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">redirect</span>(loginUrl);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 로그인된 사용자가 접근하면 안 되는 페이지 처리</span></span><br><span class="line">  <span class="keyword">if</span> ((<span class="title class_">Object</span>.<span class="title function_">values</span>(<span class="variable constant_">NEED_LOGOUT_PATH</span>) <span class="keyword">as</span> <span class="built_in">string</span>[]).<span class="title function_">includes</span>(request.<span class="property">nextUrl</span>.<span class="property">pathname</span>)) &#123;</span><br><span class="line">    <span class="keyword">if</span> (verifyResponse.<span class="property">status</span> !== <span class="number">200</span>) &#123;</span><br><span class="line">      <span class="keyword">return</span> response;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> mainUrl = <span class="keyword">new</span> <span class="title function_">URL</span>(<span class="string">&quot;/&quot;</span>, request.<span class="property">nextUrl</span>.<span class="property">origin</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">NextResponse</span>.<span class="title function_">redirect</span>(mainUrl);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> response;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>환경 분기</strong>: process.env.NODE_ENV를 통해 개발&#x2F;프로덕션 환경을 구분하여 적절한 검증 로직을 실행합니다.</li>
<li><strong>페이지 접근 제어</strong>:<ul>
<li>NEED_LOGIN_PATH: 로그인이 필요한 페이지들 (예: 마이페이지, 리뷰 작성 등)</li>
<li>NEED_LOGOUT_PATH: 비로그인 상태에서만 접근 가능한 페이지들 (예: 로그인, 회원가입)</li>
</ul>
</li>
<li><strong>명확한 리다이렉션</strong>: 인증 상태에 따라 적절한 페이지로 리다이렉트합니다.</li>
</ul>
<h2 id="▫︎-구현-시-고려-사항"><a href="#▫︎-구현-시-고려-사항" class="headerlink" title="▫︎ 구현 시 고려 사항"></a>▫︎ 구현 시 고려 사항</h2><h3 id="1-성능-최적화"><a href="#1-성능-최적화" class="headerlink" title="1. 성능 최적화"></a>1. 성능 최적화</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="attr">matcher</span>: [<span class="string">&quot;/((?!api|_next/static|_next/image|favicon.ico).*)&quot;</span>],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>선택적 실행</strong>: 모든 요청이 아닌, 필요한 경로에 대해서만 미들웨어가 실행되도록 설정</li>
<li><strong>정적 리소스 제외</strong>: 이미지, 스타일시트 등 정적 리소스는 미들웨어 처리에서 제외</li>
</ul>
<h3 id="2-서버-컴포넌트-지원"><a href="#2-서버-컴포넌트-지원" class="headerlink" title="2. 서버 컴포넌트 지원"></a>2. <strong>서버 컴포넌트 지원</strong></h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">setPathnameHeader</span> = (<span class="params">request: NextRequest, response: NextResponse</span>) =&gt; &#123;</span><br><span class="line">  response.<span class="property">headers</span>.<span class="title function_">set</span>(<span class="string">&quot;x-pathname&quot;</span>, request.<span class="property">nextUrl</span>.<span class="property">pathname</span>);</span><br><span class="line">  <span class="keyword">return</span> response;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<ul>
<li><strong>경로 정보 전달</strong>: 서버 컴포넌트에서 현재 경로 정보가 필요한 경우를 위해 헤더에 포함</li>
<li><strong>확장성</strong>: 추후 서버 컴포넌트에서 필요한 추가 정보도 헤더를 통해 전달 가능</li>
</ul>
<h1 id="▪︎-미들웨어의-Edge-Runtime을-고려한-모킹-시스템"><a href="#▪︎-미들웨어의-Edge-Runtime을-고려한-모킹-시스템" class="headerlink" title="▪︎ 미들웨어의 Edge Runtime을 고려한 모킹 시스템"></a>▪︎ 미들웨어의 <strong>Edge Runtime을 고려한 모킹 시스템</strong></h1><p>Next.js 미들웨어는 Edge Runtime에서 실행되기 때문에, api 모킹을 위해 개발 환경에서 사용하고 있던 MSW와 같은 모킹 도구를 사용할 수 없었습니다. 이를 해결하기 위한 전용 모킹 시스템을 구현했습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// middleware-mock.ts</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> mockResponses = &#123;</span><br><span class="line">  <span class="string">&quot;/auth/token/verify&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">success</span>: &#123;</span><br><span class="line">      <span class="attr">status</span>: <span class="number">200</span>,</span><br><span class="line">      <span class="attr">body</span>: &#123; <span class="attr">ok</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;Token is valid&quot;</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">error</span>: &#123;</span><br><span class="line">      <span class="attr">status</span>: <span class="number">401</span>,</span><br><span class="line">      <span class="attr">body</span>: &#123; <span class="attr">ok</span>: <span class="literal">false</span>, <span class="attr">message</span>: <span class="string">&quot;Unauthorized&quot;</span> &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> <span class="title function_">mockFetch</span> = <span class="keyword">async</span> (<span class="params">url: <span class="built_in">string</span>, options?: RequestInit</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">const</span> endpoint = <span class="keyword">new</span> <span class="title function_">URL</span>(url).<span class="property">pathname</span>;</span><br><span class="line">  <span class="keyword">const</span> mock = mockResponses[endpoint <span class="keyword">as</span> keyof <span class="keyword">typeof</span> mockResponses];</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!mock) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_">fetch</span>(url); <span class="comment">// 모킹되지 않은 엔드포인트는 실제 요청 수행</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> cookies = options?.<span class="property">headers</span> &amp;&amp; <span class="string">&quot;Cookie&quot;</span> <span class="keyword">in</span> options.<span class="property">headers</span> ? options.<span class="property">headers</span>.<span class="property">Cookie</span> : <span class="string">&quot;&quot;</span>;</span><br><span class="line">  <span class="keyword">const</span> hasAccessToken = cookies.<span class="title function_">includes</span>(<span class="string">&quot;accessToken=&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 쿠키의 토큰 존재 여부에 따라 적절한 응답 반환</span></span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Response</span>(<span class="title class_">JSON</span>.<span class="title function_">stringify</span>(hasAccessToken ? mock.<span class="property">success</span>.<span class="property">body</span> : mock.<span class="property">error</span>.<span class="property">body</span>), &#123;</span><br><span class="line">    <span class="attr">status</span>: hasAccessToken ? mock.<span class="property">success</span>.<span class="property">status</span> : mock.<span class="property">error</span>.<span class="property">status</span>,</span><br><span class="line">    <span class="attr">headers</span>: &#123; <span class="string">&quot;Content-Type&quot;</span>: <span class="string">&quot;application/json&quot;</span> &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="▫︎-모킹-시스템의-주요-특징"><a href="#▫︎-모킹-시스템의-주요-특징" class="headerlink" title="▫︎ 모킹 시스템의 주요 특징:"></a>▫︎ <strong>모킹 시스템의 주요 특징</strong>:</h2><ul>
<li><strong>엔드포인트 기반 모킹</strong>: 각 엔드포인트별로 성공&#x2F;실패 응답을 미리 정의합니다.</li>
<li><strong>토큰 기반 응답</strong>: 쿠키의 토큰 존재 여부에 따라 다른 응답을 반환합니다.</li>
<li><strong>유연한 확장</strong>: 새로운 엔드포인트 추가가 용이한 구조입니다.</li>
<li><strong>폴백 메커니즘</strong>: 모킹되지 않은 엔드포인트는 실제 API를 호출합니다.</li>
<li><strong>이러한 모킹 시스템의 장점</strong>:<ul>
<li>개발 효율성: 백엔드 API 완성 전에도 프론트엔드 개발 진행 가능</li>
<li>안정성: 예측 가능한 응답으로 일관된 개발 환경 제공</li>
<li>디버깅 용이성: 인증 관련 문제 발생 시 빠른 원인 파악 가능</li>
</ul>
</li>
</ul>
<h1 id="▪︎-마치며"><a href="#▪︎-마치며" class="headerlink" title="▪︎ 마치며"></a>▪︎ 마치며</h1><p>Next.js의 미들웨어를 활용한 인증 플로우 구현은 단순히 기능적인 요구사항을 충족시키는 것을 넘어, 사용자 경험과 코드 품질 모두를 개선하는 결과를 가져왔습니다. 특히 페이지 전환 시의 깜빡임 현상 제거와 인증 로직의 중앙 집중화는 프로젝트의 품질을 한 단계 높이는 중요한 요소가 되었습니다.</p>
<p>앞으로도 사용자 경험을 해치지 않으면서도 안전한 인증 시스템을 구축하기 위한 고민을 계속해 나갈 예정입니다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="https://namgungjongmin.github.io/2025/01/08/project/wego/%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%BD%94%EB%93%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://velog.velcdn.com/images/vbghdl/post/75242f2f-e7d2-4cd3-995b-c9cdd98b91e4/image.jpeg">
      <meta itemprop="name" content="Namgung Jong Min">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="undefined | Namgung Jong Min">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2025/01/08/project/wego/%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%BD%94%EB%93%9C/" class="post-title-link" itemprop="url">WEGO ) 테스트 코드로 더 안정적인 프로젝트 만들기: Jest를 활용한 실전 테스트 적용</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">작성일</span>

      <time title="Post created: 2025-01-08 20:42:24" itemprop="dateCreated datePublished" datetime="2025-01-08T20:42:24+09:00">2025-01-08</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Project/" itemprop="url" rel="index"><span itemprop="name">Project</span></a>
        </span>
    </span>

  
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Disqus: </span>
    
    <a title="disqus" href="/2025/01/08/project/wego/%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%BD%94%EB%93%9C/#disqus_thread" itemprop="discussionUrl">
      <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2025/01/08/project/wego/테스트코드/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p><img src="https://velog.velcdn.com/images/vbghdl/post/921dd816-acad-468d-b160-8e912a3d9f5f/image.png"></p>
<blockquote>
<p>프로젝트를 진행하면서 가장 중요하게 생각했던 것 중 하나는 코드의 안정성이었습니다. 특히 여행 관련 서비스를 개발하면서, 사용자 경험에 직접적인 영향을 미치는 UI 컴포넌트들의 안정성은 매우 중요했습니다.</p>
</blockquote>
<h1 id="▪︎-테스트-코드의-필요성"><a href="#▪︎-테스트-코드의-필요성" class="headerlink" title="▪︎ 테스트 코드의 필요성"></a>▪︎ <strong>테스트 코드의 필요성</strong></h1><h2 id="▫︎-복잡한-UI-상태-관리"><a href="#▫︎-복잡한-UI-상태-관리" class="headerlink" title="▫︎ 복잡한 UI 상태 관리"></a>▫︎ <strong>복잡한 UI 상태 관리</strong></h2><p>여행 서비스의 특성상 다양한 상태를 가진 컴포넌트들이 많았습니다. 예를 들어 리뷰 카드의 경우 아래와 같은 복잡한 상태들을 수동으로 테스트하는 것은 비효율적이며, 실수하기 쉬웠습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&#x27;리뷰 카드 컴포넌트&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> props = &#123;</span><br><span class="line">    <span class="attr">reviewId</span>: <span class="number">1</span>,</span><br><span class="line">    <span class="attr">profileImage</span>: <span class="string">&#x27;/user.jpg&#x27;</span>,</span><br><span class="line">    <span class="attr">reviewImage</span>: <span class="string">&#x27;/test.png&#x27;</span>,</span><br><span class="line">    <span class="attr">title</span>: <span class="string">&#x27;테스트 리뷰&#x27;</span>,</span><br><span class="line">    <span class="attr">content</span>: <span class="string">&#x27;이것은 테스트 리뷰 내용입니다.&#x27;</span>,</span><br><span class="line">    <span class="attr">starRating</span>: <span class="number">4.5</span>,</span><br><span class="line">    <span class="attr">travelLocation</span>: <span class="string">&#x27;서울&#x27;</span>,</span><br><span class="line">    <span class="attr">createdAt</span>: <span class="string">&#x27;2023-10-10&#x27;</span>,</span><br><span class="line">    <span class="attr">likesFlag</span>: <span class="literal">false</span>,</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;리뷰 카드가 올바르게 렌더링되어야 합니다 (리뷰 페이지)&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">renderWithQueryClient</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ReviewCard</span> &#123;<span class="attr">...props</span>&#125; <span class="attr">nickname</span>=<span class="string">&quot;테스터&quot;</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="string">&#x27;테스트 리뷰&#x27;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    <span class="title function_">expect</span>(</span><br><span class="line">      screen.<span class="title function_">getByText</span>(<span class="string">&#x27;이것은 테스트 리뷰 내용입니다.&#x27;</span>),</span><br><span class="line">    ).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="string">&#x27;테스터&#x27;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="string">&#x27;4.5&#x27;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;리뷰 카드가 올바르게 렌더링되어야 합니다 (마이페이지)&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">renderWithQueryClient</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ReviewCard</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="string">&#x27;테스트 리뷰&#x27;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    <span class="title function_">expect</span>(</span><br><span class="line">      screen.<span class="title function_">getByText</span>(<span class="string">&#x27;이것은 테스트 리뷰 내용입니다.&#x27;</span>),</span><br><span class="line">    ).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="string">&#x27;4.5&#x27;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="string">&#x27;서울&#x27;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&#x27;이미지가 올바르게 표시되어야 합니다&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">renderWithQueryClient</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ReviewCard</span> &#123;<span class="attr">...props</span>&#125; /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> image = screen.<span class="title function_">getByAltText</span>(<span class="string">&#x27;테스트 리뷰&#x27;</span>);</span><br><span class="line">    <span class="title function_">expect</span>(image).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="▫︎-비동기-데이터-처리의-안정성"><a href="#▫︎-비동기-데이터-처리의-안정성" class="headerlink" title="▫︎ 비동기 데이터 처리의 안정성"></a>▫︎ <strong>비동기 데이터 처리의 안정성</strong></h2><p>API 호출과 같은 비동기 작업이 많은 서비스 특성상, 데이터 로딩, 에러 상태 등 다양한 상황에 대한 테스트가 필요했습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&quot;로딩 중일 때 스켈레톤 UI를 표시한다&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  (useReview <span class="keyword">as</span> jest.<span class="property">Mock</span>).<span class="title function_">mockReturnValue</span>(&#123;</span><br><span class="line">    <span class="attr">isLoading</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; container &#125; = <span class="title function_">renderWithQueryClient</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ReviewContents</span> /&gt;</span></span>);</span><br><span class="line">  <span class="comment">// 스켈레톤 UI의 특정 클래스명을 기준으로 요소를 찾습니다.</span></span><br><span class="line">  <span class="keyword">const</span> skeletonElements = container.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.skeleton-style&quot;</span>);</span><br><span class="line">  <span class="title function_">expect</span>(skeletonElements.<span class="property">length</span>).<span class="title function_">toBeGreaterThan</span>(<span class="number">0</span>);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">it</span>(<span class="string">&quot;리뷰 데이터가 있을 때 리뷰 카드가 렌더링된다&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  (useReview <span class="keyword">as</span> jest.<span class="property">Mock</span>).<span class="title function_">mockReturnValue</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">pages</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">data</span>: &#123;</span><br><span class="line">            <span class="attr">content</span>: [</span><br><span class="line">              &#123;</span><br><span class="line">                <span class="attr">id</span>: <span class="number">1</span>,</span><br><span class="line">                <span class="attr">nickname</span>: <span class="string">&quot;사용자1&quot;</span>,</span><br><span class="line">                <span class="attr">profileImage</span>: <span class="string">&quot;https://example.com/profile1.jpg&quot;</span>,</span><br><span class="line">                <span class="attr">reviewImage</span>: <span class="string">&quot;https://example.com/review1.jpg&quot;</span>,</span><br><span class="line">                <span class="attr">title</span>: <span class="string">&quot;리뷰 제목 1&quot;</span>,</span><br><span class="line">                <span class="attr">content</span>: <span class="string">&quot;리뷰 내용 1&quot;</span>,</span><br><span class="line">                <span class="attr">starRating</span>: <span class="number">5</span>,</span><br><span class="line">                <span class="attr">travelLocation</span>: <span class="string">&quot;서울&quot;</span>,</span><br><span class="line">                <span class="attr">createdAt</span>: <span class="string">&quot;2023-10-01&quot;</span>,</span><br><span class="line">                <span class="attr">isLiked</span>: <span class="literal">true</span>,</span><br><span class="line">              &#125;,</span><br><span class="line">            ],</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">isLoading</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">isError</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">hasNextPage</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">fetchNextPage</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; getByText &#125; = <span class="title function_">renderWithQueryClient</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ReviewContents</span> /&gt;</span></span>);</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">getByText</span>(<span class="string">&quot;리뷰 제목 1&quot;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">getByText</span>(<span class="string">&quot;리뷰 내용 1&quot;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">it</span>(<span class="string">&quot;리뷰 데이터가 없을 때 아무것도 렌더링하지 않는다&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  (useReview <span class="keyword">as</span> jest.<span class="property">Mock</span>).<span class="title function_">mockReturnValue</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">pages</span>: [</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="attr">data</span>: &#123;</span><br><span class="line">            <span class="attr">content</span>: [],</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">      ],</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">isLoading</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">isError</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">hasNextPage</span>: <span class="literal">false</span>,</span><br><span class="line">    <span class="attr">fetchNextPage</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; queryByText &#125; = <span class="title function_">renderWithQueryClient</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ReviewContents</span> /&gt;</span></span>);</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">queryByText</span>(<span class="regexp">/리뷰 제목 1/i</span>)).<span class="property">not</span>.<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h1 id="▪︎-테스트-코드-작성-전략"><a href="#▪︎-테스트-코드-작성-전략" class="headerlink" title="▪︎ 테스트 코드 작성 전략"></a>▪︎ 테스트 코드 작성 전략</h1><h2 id="▫︎-테스트-시나리오-구성"><a href="#▫︎-테스트-시나리오-구성" class="headerlink" title="▫︎ 테스트 시나리오 구성"></a>▫︎ <strong>테스트 시나리오 구성</strong></h2><p>테스트 코드는 크게 세 가지 관점에서 작성했습니다.</p>
<h3 id="1-기본-렌더링-테스트"><a href="#1-기본-렌더링-테스트" class="headerlink" title="1. 기본 렌더링 테스트"></a>1. 기본 렌더링 테스트</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">describe</span>(<span class="string">&quot;ReviewComment&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">it</span>(<span class="string">&quot;리뷰 작성칸을 렌더링합니다&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ReviewComment</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="string">&quot;여행에 대한 후기를 남겨주세요!&quot;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByLabelText</span>(<span class="string">&quot;최대 20자 입력 가능 textarea&quot;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByPlaceholderText</span>(<span class="string">&quot;여행 제목을 입력해 주세요.&quot;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByLabelText</span>(<span class="string">&quot;최대 100자 입력 가능 textarea&quot;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">    <span class="title function_">expect</span>(screen.<span class="title function_">getByPlaceholderText</span>(<span class="string">&quot;여행에 대한 다양한 후기를 공유해 주세요!&quot;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="2-사용자-인터렉션-테스트"><a href="#2-사용자-인터렉션-테스트" class="headerlink" title="2. 사용자 인터렉션 테스트"></a>2. 사용자 인터렉션 테스트</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&quot;페이지 버튼 클릭 시 paginate 함수가 호출된다&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> paginateMock = jest.<span class="title function_">fn</span>();</span><br><span class="line">  <span class="keyword">const</span> &#123; getByText &#125; = <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Pagination</span> <span class="attr">totalPages</span>=<span class="string">&#123;4&#125;</span> <span class="attr">currentPage</span>=<span class="string">&#123;1&#125;</span> <span class="attr">paginate</span>=<span class="string">&#123;paginateMock&#125;</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">  fireEvent.<span class="title function_">click</span>(<span class="title function_">getByText</span>(<span class="string">&quot;2&quot;</span>));</span><br><span class="line">  <span class="title function_">expect</span>(paginateMock).<span class="title function_">toHaveBeenCalledWith</span>(<span class="number">2</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="3-엣지-케이스-테스트"><a href="#3-엣지-케이스-테스트" class="headerlink" title="3. 엣지 케이스 테스트"></a>3. 엣지 케이스 테스트</h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&quot;리뷰 데이터가 없을 때 빈 상태 메시지를 렌더링한다&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  (useMyReview <span class="keyword">as</span> jest.<span class="property">Mock</span>).<span class="title function_">mockReturnValue</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">content</span>: [],</span><br><span class="line">        <span class="attr">total</span>: <span class="number">0</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">renderWithProvider</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">Written</span> /&gt;</span></span>);</span><br><span class="line"></span><br><span class="line">  <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="string">&quot;아직 작성한 리뷰가 없어요!&quot;</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="▫︎-비동기-테스트-처리"><a href="#▫︎-비동기-테스트-처리" class="headerlink" title="▫︎ 비동기 테스트 처리"></a>▫︎ <strong>비동기 테스트 처리</strong></h2><h3 id="1-로딩-상태-처리"><a href="#1-로딩-상태-처리" class="headerlink" title="1. 로딩 상태 처리"></a>1. <strong>로딩 상태 처리</strong></h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&quot;로딩 중일 때 스켈레톤 UI를 표시한다&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  (useReview <span class="keyword">as</span> jest.<span class="property">Mock</span>).<span class="title function_">mockReturnValue</span>(&#123;</span><br><span class="line">    <span class="attr">isLoading</span>: <span class="literal">true</span>,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; container &#125; = <span class="title function_">renderWithQueryClient</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">ReviewContents</span> /&gt;</span></span>);</span><br><span class="line">  <span class="comment">// 스켈레톤 UI의 특정 클래스명을 기준으로 요소를 찾습니다.</span></span><br><span class="line">  <span class="keyword">const</span> skeletonElements = container.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.skeleton-style&quot;</span>);</span><br><span class="line">  <span class="title function_">expect</span>(skeletonElements.<span class="property">length</span>).<span class="title function_">toBeGreaterThan</span>(<span class="number">0</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="2-데이터-페칭-결과-처리"><a href="#2-데이터-페칭-결과-처리" class="headerlink" title="2. 데이터 페칭 결과 처리"></a>2. <strong>데이터 페칭 결과 처리</strong></h3><figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&quot;여행 데이터가 있을 때 여행 카드가 렌더링된다&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  (usePastTravel <span class="keyword">as</span> jest.<span class="property">Mock</span>).<span class="title function_">mockReturnValue</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>: &#123;</span><br><span class="line">      <span class="attr">data</span>: &#123;</span><br><span class="line">        <span class="attr">content</span>: [</span><br><span class="line">          &#123;</span><br><span class="line">            <span class="attr">travelId</span>: <span class="number">1</span>,</span><br><span class="line">            <span class="attr">travelName</span>: <span class="string">&quot;과거 여행 1&quot;</span>,</span><br><span class="line">            <span class="attr">maxTravelMateCount</span>: <span class="number">5</span>,</span><br><span class="line">            <span class="attr">currentTravelMateCount</span>: <span class="number">2</span>,</span><br><span class="line">            <span class="attr">isDomestic</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">location</span>: <span class="string">&quot;서울&quot;</span>,</span><br><span class="line">            <span class="attr">image</span>: <span class="string">&quot;https://example.com/image.jpg&quot;</span>,</span><br><span class="line">            <span class="attr">startAt</span>: <span class="string">&quot;2023-10-01&quot;</span>,</span><br><span class="line">            <span class="attr">endAt</span>: <span class="string">&quot;2023-10-10&quot;</span>,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">        <span class="attr">total</span>: <span class="number">1</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> &#123; getByText &#125; = <span class="title function_">renderWithQueryClient</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">PastTravel</span> /&gt;</span></span>);</span><br><span class="line">  <span class="title function_">expect</span>(<span class="title function_">getByText</span>(<span class="regexp">/과거 여행 1/i</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h3 id="3-에러-상태-처리"><a href="#3-에러-상태-처리" class="headerlink" title="3. 에러 상태 처리"></a>3. 에러 상태 처리</h3><p>추가로 각 컴포넌트에서 발생할 수 있는 에러 상황을 고려하여 테스트케이스를 작성했습니다.</p>
<h2 id="▫︎-모킹-전략-활용"><a href="#▫︎-모킹-전략-활용" class="headerlink" title="▫︎ 모킹 전략 활용"></a>▫︎ 모킹 전략 활용</h2><p>외부 의존성이 있는 컴포넌트의 경우, 적절한 모킹을 통해 테스트의 안정성을 확보했습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">jest.<span class="title function_">mock</span>(<span class="string">&quot;next/navigation&quot;</span>, <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">  <span class="attr">useRouter</span>: <span class="function">() =&gt;</span> (&#123;</span><br><span class="line">    <span class="attr">push</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">    <span class="attr">replace</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">    <span class="attr">back</span>: jest.<span class="title function_">fn</span>(),</span><br><span class="line">    <span class="comment">// 필요한 다른 router 메서드들...</span></span><br><span class="line">  &#125;),</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>

<h1 id="▪︎-테스트-코드-작성-시-중점-사항"><a href="#▪︎-테스트-코드-작성-시-중점-사항" class="headerlink" title="▪︎ 테스트 코드 작성 시 중점 사항"></a>▪︎ <strong>테스트 코드 작성 시 중점 사항</strong></h1><h2 id="▫︎-테스트-가독성"><a href="#▫︎-테스트-가독성" class="headerlink" title="▫︎ 테스트 가독성"></a>▫︎ <strong>테스트 가독성</strong></h2><p>각 테스트 케이스의 의도가 명확히 드러나도록 작성했습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">it</span>(<span class="string">&#x27;기본적으로 &quot;myTravel&quot; 탭이 선택되어야 한다&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">renderWithQueryClient</span>(</span><br><span class="line">    <span class="language-xml"><span class="tag">&lt;<span class="name">MainTab</span> <span class="attr">selectedTab</span>=<span class="string">&quot;myTravel&quot;</span> <span class="attr">setSelectedTab</span>=<span class="string">&#123;setSelectedTabMock&#125;</span> <span class="attr">setSelectedSubTab</span>=<span class="string">&#123;setSelectedSubTabMock&#125;</span> /&gt;</span></span></span><br><span class="line">  );</span><br><span class="line"></span><br><span class="line">  <span class="title function_">expect</span>(screen.<span class="title function_">getByText</span>(<span class="regexp">/나의 여행/i</span>)).<span class="title function_">toBeInTheDocument</span>();</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h2 id="▫︎-테스트-유지보수성"><a href="#▫︎-테스트-유지보수성" class="headerlink" title="▫︎ 테스트 유지보수성"></a>▫︎ <strong>테스트 유지보수성</strong></h2><p>반복되는 테스트 로직은 유틸리티 함수로 분리하여 재사용성을 높였습니다.</p>
<figure class="highlight tsx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">renderWithProvider</span> = (<span class="params">ui: React.ReactNode</span>) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title function_">render</span>(<span class="language-xml"><span class="tag">&lt;<span class="name">QueryClientProvider</span> <span class="attr">client</span>=<span class="string">&#123;queryClient&#125;</span>&gt;</span>&#123;ui&#125;<span class="tag">&lt;/<span class="name">QueryClientProvider</span>&gt;</span></span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h1 id="▪︎-마치며"><a href="#▪︎-마치며" class="headerlink" title="▪︎ 마치며"></a>▪︎ 마치며</h1><p>테스트 코드 작성은 단순히 버그를 잡기 위한 도구가 아닌, 더 나은 설계를 위한 도구이자 문서의 역할도 수행했습니다. 특히 비동기 처리가 많은 현대 웹 애플리케이션에서 다양한 상황에 대한 테스트 케이스를 작성함으로써, 더 안정적인 서비스를 제공할 수 있었습니다.</p>
<p>앞으로도 테스트 커버리지를 높이고, 더 효율적인 테스트 전략을 발전시켜 나갈 예정입니다.</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" title="다음 페이지" aria-label="다음 페이지" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>

</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">

  <div class="copyright">
    &copy; 
    <span itemprop="copyrightYear">2025</span>
    <span class="with-love">
      <i class="fa fa-heart"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">Namgung Jong Min</span>
  </div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="back-to-top" role="button" aria-label="Back to top">
    <i class="fa fa-arrow-up fa-lg"></i>
    <span>0%</span>
  </div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/sidebar.js"></script><script src="/js/next-boot.js"></script>

  






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>




<script class="next-config" data-name="disqus" type="application/json">{"enable":true,"shortname":"namgungjongmin","count":true,"lazylaod":false,"i18n":{"disqus":"disqus"}}</script>
<script src="/js/third-party/comments/disqus.js"></script>

</body>
</html>
